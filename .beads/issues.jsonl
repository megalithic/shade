{"id":".dotfiles-32b","title":"Fix inconsistent EDITOR/VISUAL/JJ_EDITOR configuration","description":"Editor environment variables are configured in multiple conflicting places, causing tools like jj to fail when opening editors.\n\nCurrent State (broken):\n- EDITOR=nvim (just binary name)\n- VISUAL=/nix/store/.../nvim (full nix path)\n- JJ_EDITOR=(empty)\n- GIT_EDITOR=$EDITOR\n\nSources of Conflict:\n1. hosts/megabookpro.nix:61-63 - Sets EDITOR to pkgs.nvim-nightly/bin/nvim\n2. home/zsh/lib/env.zsh:93 - Sets EDITOR='nvim -O' (with -O flag!)\n3. home/programs/nvim.nix:42 - defaultEditor = true (may also set things)\n4. JJ_EDITOR - Never explicitly set\n\nProblem Discovered:\n- jj split failed because editor didn't work properly\n- Concurrent AI agent changes got wrong commit messages\n- nvim client/server mode (from notes system) may have changed expected behavior\n\nRequired Fix:\n1. Consolidate editor config in ONE place (probably nix)\n2. Remove conflicting zsh env.zsh EDITOR override\n3. Set JJ_EDITOR explicitly (may need different behavior than git)\n4. Test that all tools work: jj, git, bd, fish edit_command_buffer\n5. Ensure nvim client/server mode doesn't break interactive editing\n\nRelated: Notes \u0026 Capture system may have changed nvim startup behavior","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-29T08:54:57.499263-05:00","updated_at":"2026-01-09T11:33:43.85741-05:00","closed_at":"2026-01-09T10:57:01.390834-05:00","close_reason":"No longer relevant or already resolved","labels":["bug","dx","jj","nix","nvim"]}
{"id":".dotfiles-ahf.10","title":"[Future] Add MLXVLM for direct image understanding","description":"Evaluate Vision-Language Models (VLM) like Gemma-3-4B or Qwen2-VL for direct image understanding without OCR step. Compare quality/speed vs VisionKit+LLM pipeline.","status":"tombstone","priority":4,"issue_type":"task","created_at":"2026-01-09T13:18:15.350997-05:00","updated_at":"2026-01-13T11:51:21.963392-05:00","dependencies":[{"issue_id":".dotfiles-ahf.10","depends_on_id":".dotfiles-ahf","type":"parent-child","created_at":"2026-01-09T13:18:15.351666-05:00","created_by":"seth","metadata":"{}"}],"deleted_at":"2026-01-13T11:51:21.963392-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".dotfiles-ahf.13","title":"Add CLI argument parsing that merges with config file","description":"Implement config precedence:\n1. CLI flags override config file\n2. Environment variables override CLI\n3. Merge logic for partial overrides","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-09T13:29:31.726939-05:00","updated_at":"2026-01-13T11:51:21.963392-05:00","dependencies":[{"issue_id":".dotfiles-ahf.13","depends_on_id":".dotfiles-ahf","type":"parent-child","created_at":"2026-01-09T13:29:31.727682-05:00","created_by":"seth","metadata":"{}"}],"deleted_at":"2026-01-13T11:51:21.963392-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".dotfiles-ahf.15","title":"Implement async enrichment task manager","description":"Create AsyncEnrichmentManager that:\n1. Accepts OCR text + context after capture\n2. Kicks off background Swift Task for LLM inference\n3. Tracks pending enrichments by buffer ID\n4. Handles cancellation if buffer closes","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-09T15:49:01.711738-05:00","updated_at":"2026-01-13T11:51:21.963392-05:00","dependencies":[{"issue_id":".dotfiles-ahf.15","depends_on_id":".dotfiles-ahf","type":"parent-child","created_at":"2026-01-09T15:49:01.712571-05:00","created_by":"seth","metadata":"{}"}],"deleted_at":"2026-01-13T11:51:21.963392-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".dotfiles-ahf.16","title":"Insert placeholders via nvim RPC after OCR","description":"After VisionKit OCR completes:\n1. Insert OCR text into capture note\n2. Add placeholder comments: \u003c!-- shade:pending:summary --\u003e and \u003c!-- shade:pending:tags --\u003e\n3. Optionally add virtual text '⏳ Generating...' indicator\n4. Track placeholder line numbers for later replacement","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-09T15:49:02.551164-05:00","updated_at":"2026-01-13T11:51:21.963392-05:00","dependencies":[{"issue_id":".dotfiles-ahf.16","depends_on_id":".dotfiles-ahf","type":"parent-child","created_at":"2026-01-09T15:49:02.551822-05:00","created_by":"seth","metadata":"{}"}],"deleted_at":"2026-01-13T11:51:21.963392-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".dotfiles-ahf.17","title":"Replace placeholders when LLM enrichment completes","description":"When async LLM task completes:\n1. Find placeholder comments in buffer via nvim_buf_get_lines\n2. Replace \u003c!-- shade:pending:summary --\u003e with actual summary\n3. Replace \u003c!-- shade:pending:tags --\u003e with formatted tags (#tag1 #tag2)\n4. Remove virtual text indicator\n5. Send nvim notification (nvim_echo or floating window)","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-09T15:49:03.29425-05:00","updated_at":"2026-01-13T11:51:21.963392-05:00","dependencies":[{"issue_id":".dotfiles-ahf.17","depends_on_id":".dotfiles-ahf","type":"parent-child","created_at":"2026-01-09T15:49:03.294942-05:00","created_by":"seth","metadata":"{}"}],"deleted_at":"2026-01-13T11:51:21.963392-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".dotfiles-ahf.18","title":"Handle edge cases: buffer closed, user edited placeholder","description":"Gracefully handle:\n1. User closes buffer before enrichment completes - cancel task, log\n2. User manually edited/deleted placeholder - skip replacement, notify\n3. User switched to different buffer - still replace in original buffer\n4. Multiple captures in flight - track by unique ID","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-09T15:49:04.47155-05:00","updated_at":"2026-01-13T11:51:21.963392-05:00","dependencies":[{"issue_id":".dotfiles-ahf.18","depends_on_id":".dotfiles-ahf","type":"parent-child","created_at":"2026-01-09T15:49:04.47228-05:00","created_by":"seth","metadata":"{}"}],"deleted_at":"2026-01-13T11:51:21.963392-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".dotfiles-ahf.5","title":"Wire MLX into OCR pipeline (after VisionKit extraction)","description":"After VisionKit extracts text, pass it to MLXInferenceEngine.summarize() and inject the result into the capture note.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-09T13:18:00.99362-05:00","updated_at":"2026-01-13T11:51:21.963392-05:00","dependencies":[{"issue_id":".dotfiles-ahf.5","depends_on_id":".dotfiles-ahf","type":"parent-child","created_at":"2026-01-09T13:18:00.994267-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-ahf.5","depends_on_id":"shade-cgn.2","type":"blocks","created_at":"2026-01-09T13:18:14.686256-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-ahf.5","depends_on_id":".dotfiles-cgn.2","type":"blocks","created_at":"2026-01-09T13:18:14.686256-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-ahf.5","depends_on_id":"shade-cmv","type":"blocks","created_at":"2026-01-12T12:47:03.012834-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-ahf.5","depends_on_id":".dotfiles-cmv","type":"blocks","created_at":"2026-01-12T12:47:03.012834-05:00","created_by":"seth","metadata":"{}"}],"deleted_at":"2026-01-13T11:51:21.963392-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".dotfiles-ahf.7","title":"Add MLX RPC commands to ShadeServer","description":"Expose shade.summarize, shade.categorize, shade.model_status, and shade.model_unload via ShadeServer RPC interface.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-09T13:18:03.06863-05:00","updated_at":"2026-01-13T11:51:21.963392-05:00","dependencies":[{"issue_id":".dotfiles-ahf.7","depends_on_id":".dotfiles-ahf","type":"parent-child","created_at":"2026-01-09T13:18:03.069316-05:00","created_by":"seth","metadata":"{}"}],"deleted_at":"2026-01-13T11:51:21.963392-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".dotfiles-ahf.8","title":"Auto-download model on first use with progress","description":"Handle first-time model download gracefully with progress reporting. Cache in ~/.cache/shade/models/ or HuggingFace cache.","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-09T13:18:03.922985-05:00","updated_at":"2026-01-13T11:51:21.963392-05:00","dependencies":[{"issue_id":".dotfiles-ahf.8","depends_on_id":".dotfiles-ahf","type":"parent-child","created_at":"2026-01-09T13:18:03.923645-05:00","created_by":"seth","metadata":"{}"}],"deleted_at":"2026-01-13T11:51:21.963392-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".dotfiles-ahf.9","title":"Implement model unloading after idle timeout","description":"Free model memory after configurable idle timeout (e.g., 5 minutes) to reduce memory pressure when not in use.","status":"tombstone","priority":3,"issue_type":"task","created_at":"2026-01-09T13:18:05.002363-05:00","updated_at":"2026-01-13T11:51:21.963392-05:00","dependencies":[{"issue_id":".dotfiles-ahf.9","depends_on_id":".dotfiles-ahf","type":"parent-child","created_at":"2026-01-09T13:18:05.003203-05:00","created_by":"seth","metadata":"{}"}],"deleted_at":"2026-01-13T11:51:21.963392-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":".dotfiles-wvu","title":"Fix app context modal keybindings (disabled due to bugs)","description":"# App Context Modal Keybindings - RE-ENABLING\n\nModal keybindings for app contexts (Slack, Messages, Teams) were disabled due to bugs. Now re-enabling with global flag control.\n\n## Primary Symptom (Clarified 2026-01-19)\n**Modal stays active after leaving app** - switching from Slack to Finder, Ctrl+J/K still fires.\n**Problem is immediate** - not an accumulation/timing issue.\n\n## Implementation Plan\n\n### Phase 0: Lift Flags to Globals (ENABLED by default)\nRefactor module-local flags to Lua globals for runtime control:\n- `_G.APP_MODALS_ENABLED = true` (enabled by default)\n- `_G.DEBUG = false` (off by default)\n\nChanges in `contexts/init.lua`:\n1. Remove `M.DEBUG` and `M.MODALS_ENABLED`\n2. Initialize globals: `if _G.APP_MODALS_ENABLED == nil then _G.APP_MODALS_ENABLED = true end`\n3. Update all references: `M.DEBUG` → `_G.DEBUG`, `M.MODALS_ENABLED` → `_G.APP_MODALS_ENABLED`\n\nRuntime control (no reload needed):\n- Disable: `_G.APP_MODALS_ENABLED = false`\n- Debug: `_G.DEBUG = true`\n\n### Phase 1: Test + Debug\n1. Reload Hammerspoon\n2. Test: Slack → Ctrl+J → Finder → Ctrl+J (should NOT fire in Finder)\n3. If broken, enable debug: `_G.DEBUG = true`\n4. Observe console for ACTIVATION/DEACTIVATION/MODAL ENTERED/EXITED logs\n\n### Phase 2: Fix (based on debug output)\nMost likely: deactivation event not reaching context orchestrator\nFix: Exit all active modals before entering new one (defensive cleanup)\n\n## Key Files\n- `config/hammerspoon/contexts/init.lua` - Modal orchestrator\n- `config/hammerspoon/contexts/com.tinyspeck.slackmacgap.lua` - Slack (Ctrl+J/K/N/P)\n- `config/hammerspoon/contexts/com.apple.MobileSMS.lua` - Messages\n- `config/hammerspoon/watchers/app.lua` - App watcher\n\n## Previous Work (Reference)\n- Added `_bindingsCreated` guard to prevent binding accumulation\n- Removed redundant `modal:enter()`/`modal:exit()` from individual contexts\n- Centralized modal lifecycle in orchestrator\n","status":"open","priority":2,"issue_type":"bug","created_at":"2026-01-12T13:00:35.70971-05:00","created_by":"seth","updated_at":"2026-01-20T14:11:35.215578-05:00","close_reason":"Fixed by adding defensive exitAllActiveModals() cleanup before entering any modal. Lifted flags to globals for runtime control."}
{"id":"shade-0ii","title":"Audit and remove deprecated image capture code from Hammerspoon","description":"After shade-cmv consolidated image handling into Shade, audit HS for deprecated code:\n\n## Code to audit/remove\n- lib/notes.lua: copyImageToAssets(), deleteLocalScreenshot(), deleteFromSpaces() - if only used for image capture\n- clipper.lua: Any remaining dead code paths referencing old flow\n- Any HS code still referencing vault/assets paths that Shade now owns\n\n## Validation required\n- HS reloads without errors\n- HS loads cleanly on startup\n- HS shuts down without errors\n- Image capture flow still works end-to-end (screenshot → n → note created)\n\n## Safety protocol\n- Remove one function at a time\n- Reload and validate after each removal\n- Keep lib/notes.lua functions needed for daily note paths\n\nRelated: shade-cmv (completed)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-13T07:43:00.867766-05:00","updated_at":"2026-01-13T09:07:19.288709-05:00","closed_at":"2026-01-13T09:07:19.288709-05:00"}
{"id":"shade-155","title":"Critical notifications on primaryScreen","description":"Make critical/high urgency notifications always appear on hs.screen.primaryScreen() (external monitor) instead of following the focused window. Both the notification canvas and dimming overlay should use primaryScreen when urgency is critical/high (center position).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T11:03:10.402997-05:00","updated_at":"2026-01-05T11:06:04.728273-05:00","closed_at":"2026-01-05T11:06:04.728273-05:00","close_reason":"Implemented in commit: fix(hammerspoon): correct Fantastical bundleID and show critical notifications on primaryScreen"}
{"id":"shade-1br","title":"Smart text parsing for captures: auto-detect and convert URLs to markdown links","description":"When capturing selected text, detect URL-like patterns and convert them to markdown link format.\n\n## Requirements\n- Detect bare URLs (http://, https://, file://)\n- Detect URL-like strings without protocol (e.g., github.com/user/repo)\n- Convert to markdown: [url](url) or just make clickable\n- Consider wikilink format [[page]] for internal references\n- Handle edge cases: URLs in parentheses, trailing punctuation\n\n## Research needed\n- How do other note-taking apps (Obsidian, Notion, Bear) handle this?\n- What regex patterns are robust for URL detection?\n- Should this be opt-in or automatic?","status":"in_progress","priority":2,"issue_type":"feature","created_at":"2026-01-19T13:32:57.213388-05:00","updated_at":"2026-01-19T16:37:02.479706-05:00"}
{"id":"shade-2gr","title":"Fix DB.connections.getEvents() querying wrong table","description":"## Problem\n`DB.connections.getEvents()` in `lib/db.lua` queries the `notifications` table instead of the `connection_events` table. This is a copy-paste bug.\n\n## Current Code (lines 635-661)\n```lua\nfunction M.connections.getEvents(hours)\n  -- ...\n  local query = fmt([[\n    SELECT ... FROM notifications  -- BUG: Should be connection_events!\n    WHERE timestamp \u003e= %d\n      AND shown = 0\n      AND action = 'blocked'\n      AND action_detail = 'blocked_by_focus'\n    ...\n  ]], cutoff)\nend\n```\n\n## Impact\n- `connections.getEvents()` returns the same data as `notifications.getBlockedByFocus()`\n- Network events (internet/router connected/disconnected) are never displayed in menubar\n- The menubar's \"network\" category is effectively broken\n\n## Fix\nUpdate the query to use `connection_events` table with appropriate columns (id, timestamp, event_type, dismissed)\n\n## Related\n- Parent bug: shade-jxw (menubar clear all events not working)","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-12T10:18:54.135745-05:00","updated_at":"2026-01-12T10:19:58.859339-05:00","closed_at":"2026-01-12T10:19:58.859339-05:00","close_reason":"Fixed: DB.connections.getEvents() now queries connection_events table with correct columns"}
{"id":"shade-32b","title":"Fix inconsistent EDITOR/VISUAL/JJ_EDITOR configuration","description":"Editor environment variables are configured in multiple conflicting places, causing tools like jj to fail when opening editors.\n\nCurrent State (broken):\n- EDITOR=nvim (just binary name)\n- VISUAL=/nix/store/.../nvim (full nix path)\n- JJ_EDITOR=(empty)\n- GIT_EDITOR=$EDITOR\n\nSources of Conflict:\n1. hosts/megabookpro.nix:61-63 - Sets EDITOR to pkgs.nvim-nightly/bin/nvim\n2. home/zsh/lib/env.zsh:93 - Sets EDITOR='nvim -O' (with -O flag!)\n3. home/programs/nvim.nix:42 - defaultEditor = true (may also set things)\n4. JJ_EDITOR - Never explicitly set\n\nProblem Discovered:\n- jj split failed because editor didn't work properly\n- Concurrent AI agent changes got wrong commit messages\n- nvim client/server mode (from notes system) may have changed expected behavior\n\nRequired Fix:\n1. Consolidate editor config in ONE place (probably nix)\n2. Remove conflicting zsh env.zsh EDITOR override\n3. Set JJ_EDITOR explicitly (may need different behavior than git)\n4. Test that all tools work: jj, git, bd, fish edit_command_buffer\n5. Ensure nvim client/server mode doesn't break interactive editing\n\nRelated: Notes \u0026 Capture system may have changed nvim startup behavior","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-29T08:54:57.499263-05:00","updated_at":"2026-01-09T11:33:43.85741-05:00","closed_at":"2026-01-09T10:57:01.390834-05:00","close_reason":"No longer relevant or already resolved","labels":["bug","dx","jj","nix","nvim"]}
{"id":"shade-3jb","title":"Remove redundant modal enter/exit from Teams context","description":"Same issue as Slack: Teams context (com.microsoft.teams2.lua) manually calls modal:enter() in start() (line 32) and has extensive dead/commented code.\n\nFix: Remove manual modal management, rely on context orchestrator.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-12T11:06:19.002471-05:00","updated_at":"2026-01-12T11:11:45.943679-05:00","closed_at":"2026-01-12T11:11:45.943679-05:00","close_reason":"Removed redundant modal enter/exit calls - orchestrator handles lifecycle now","dependencies":[{"issue_id":"shade-3jb","depends_on_id":"shade-m1t","type":"blocks","created_at":"2026-01-12T11:06:26.262758-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-42y","title":"Dotfiles support for Shade MLX/LLM integration","description":"Track dotfiles-side work for Shade MLX integration. Corresponds to shade-ahf epic in shade repo.\n\n## Cross-repo coordination:\n- shade-ahf.1-3: MLX engine (shade repo) - DONE\n- shade-ahf.11-12: ShadeConfig (shade repo) - DONE  \n- This epic: Config generation + template updates (dotfiles repo)\n- shade-ahf.15-17: Async pipeline (shade repo) - needs template placeholders from here","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-11T14:35:19.038625-05:00","updated_at":"2026-01-11T14:35:19.038625-05:00"}
{"id":"shade-4zt","title":"Create shade.nix home-manager module for LLM config","description":"Generate ~/.config/shade/config.json via Nix with LLM settings. Cross-repo: implements shade-ahf.14 from shade repo.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-11T14:34:52.835256-05:00","updated_at":"2026-01-11T14:48:11.745916-05:00","closed_at":"2026-01-11T14:48:11.745916-05:00","close_reason":"Created home/programs/shade.nix generating ~/.config/shade/config.json with LLM, capture, and window configuration","dependencies":[{"issue_id":"shade-4zt","depends_on_id":"shade-42y","type":"parent-child","created_at":"2026-01-11T14:35:35.508539-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-5y5","title":"[Research] Deep audit of Nix config duplication and redundancy","description":"## Objective\nDeep dive into the Nix configuration to identify and validate areas of duplication, redundancy, and unclear module boundaries. Build on Phases 1-2 of the existing reorganization work.\n\n## Scope\n1. **Path Definition Duplication** - Validate paths defined in both hosts/megabookpro.nix AND home/default.nix\n2. **Package Installation Duplication** - Verify packages in both environment.systemPackages AND home-manager programs.X\n3. **Environment Variable Overlap** - Check env vars set at system AND user level\n4. **App Installation Method Confusion** - Clarify brew vs mkApp vs nixpkgs boundaries\n5. **Config Sourcing Inconsistency** - Document out-of-store vs in-store vs generated patterns\n\n## Deliverables\n- Updated _docs/nix-dotfiles-reorganization-research.md with:\n  - Validated findings with specific file:line references\n  - Clear refactoring recommendations\n  - Priority-ordered tasks for Phase 3+\n- Beads for actionable refactoring work\n\n## Related\n- Existing research: _docs/nix-dotfiles-reorganization-research.md\n- Phases 1-2 complete, Phases 3-4 not started","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T07:58:42.515859-05:00","updated_at":"2026-01-14T08:00:44.304858-05:00","closed_at":"2026-01-14T08:00:44.304858-05:00","close_reason":"Research complete. Updated _docs/nix-dotfiles-reorganization-research.md with validated findings. Created 3 actionable tasks: .dotfiles-kcj (paths), .dotfiles-795 (packages), .dotfiles-d1e (routing docs)"}
{"id":"shade-68z","title":"Update obsidian.nvim capture-image template with LLM placeholders","description":"Add \u003c!-- shade:pending:summary --\u003e and \u003c!-- shade:pending:tags --\u003e placeholders for async LLM enrichment. Cross-repo: works with shade-ahf.16/17.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-11T14:35:01.172578-05:00","updated_at":"2026-01-12T08:12:34.215919-05:00","closed_at":"2026-01-12T08:12:34.215919-05:00","close_reason":"Added LLM placeholders to capture-image.md template","dependencies":[{"issue_id":"shade-68z","depends_on_id":"shade-42y","type":"parent-child","created_at":"2026-01-11T14:35:35.567607-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-795","title":"[Nix] Remove duplicate packages from environment.systemPackages","description":"## Problem\nPackages are installed TWICE - in environment.systemPackages AND via programs.X.enable:\n\n| Package | system.nix | home location |\n|---------|------------|---------------|\n| bat | :133 | programs.bat.enable (:471) |\n| git | :144 | programs.git.enable (:378) |\n| ripgrep | :165 | programs.ripgrep.enable (:497) |\n| fd | :141 | programs.fd.enable (:501) |\n| eza | :140 | programs.eza.enable (:457) |\n| zoxide | :173 | programs.zoxide.enable (:424) |\n| starship | :166 | programs.starship.enable (:374) |\n\nWhen programs.X.enable = true, home-manager auto-installs the package.\n\n## Solution\nRemove duplicates from modules/system.nix. Keep ONLY packages that:\n1. Don't have home-manager modules (delta, coreutils, etc.)\n2. Need system-wide availability before user login\n\n## Files to modify\n- EDIT: modules/system.nix (hosts/megabookpro.nix:123-177)\n\n## Acceptance criteria\n- [ ] No duplicate packages\n- [ ] darwin-rebuild succeeds\n- [ ] All tools still work (bat, git, rg, fd, eza, zoxide, starship)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T08:00:34.295806-05:00","updated_at":"2026-01-14T08:00:34.295806-05:00","dependencies":[{"issue_id":"shade-795","depends_on_id":"shade-kcj","type":"blocks","created_at":"2026-01-14T08:00:39.566532-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-7g5","title":"Debug HS notification rules: important messages not overriding focus modes","description":"## Problem\nThe \"Important Messages\" rule for \"Abby Messer\" title has `overrideFocusModes = true`, but message content is still being redacted (shown as •••) when in Work or DND focus mode.\n\n## Investigation Findings\n\n### Root Cause\nTwo **separate mechanisms** control notification behavior during focus modes:\n\n1. **`overrideFocusModes`** (processor.lua:48-71) - Controls whether notification is **shown at all**\n   - `true` = show even when focus mode is active\n   - ✅ This IS working correctly\n\n2. **Content Redaction** (notifier.lua:636-652) - Controls whether message **content is visible**\n   ```lua\n   local shouldRedact = currentFocus == \"Do Not Disturb\" or currentFocus == \"Work\"\n   if shouldRedact then\n     -- Replace each character with \"•\"\n   end\n   ```\n   - ❌ This does NOT check per-rule settings - redacts ALL notifications in Work/DND\n\n### Evidence from Database\nNotifications ARE being shown (not blocked):\n```\naction=redirect, action_detail=shown_bottom_left, focus_mode=Work\n```\n\nThe issue is redaction, not blocking.\n\n## Proposed Fix\n\n**Option A (Recommended)**: Reuse `overrideFocusModes = true` to also bypass redaction\n- Rationale: If notification is important enough to override focus blocking, it's important enough to show full content\n- Simpler mental model, no new config keys needed\n\n**Option B**: Add new `bypassRedaction = true` key\n- More granular control\n- But adds complexity\n\n### Implementation (Option A)\n\nIn `notifier.lua` around line 636, the redaction logic needs to receive the matched rule and check:\n\n```lua\n-- Check if we should redact notification content based on focus mode\nlocal currentFocus = M.getCurrentFocusMode and M.getCurrentFocusMode() or nil\nlocal shouldRedact = currentFocus == \"Do Not Disturb\" or currentFocus == \"Work\"\n\n-- Allow rules with overrideFocusModes to bypass redaction\nif opts.rule and opts.rule.overrideFocusModes == true then\n  shouldRedact = false\nend\n\nif shouldRedact then\n  -- ... redaction logic\nend\n```\n\nThis requires passing the matched rule through to `sendCanvasNotification()`.\n\n## Files to Modify\n- `config/hammerspoon/lib/notifications/notifier.lua` - Add rule check to redaction logic\n- `config/hammerspoon/lib/notifications/processor.lua` - Pass rule to notifier\n\n## Related Config\nRule location: `config/hammerspoon/config.lua` lines 432-451","status":"open","priority":2,"issue_type":"bug","created_at":"2026-01-12T09:07:13.871302-05:00","updated_at":"2026-01-12T09:26:27.175406-05:00"}
{"id":"shade-8g2","title":"Shade: Update Hammerspoon integration for MegaNote → Shade rename","description":"Update Hammerspoon configuration to work with the renamed Shade app.\n\n## Related\n- Shade repo epic: shade-141 (in ~/code/MegaNote → ~/code/shade)\n\n## Scope\n- Rename interop/meganote.lua → interop/shade.lua\n- Update IPC notifications: com.meganote.* → io.shade.*\n- Update binary paths and process names\n- Add io.shade.note.capture handler (write context.json, send notification)\n- Add io.shade.note.daily handler\n- Update keybindings\n- Update notes.lua to use new module\n\n## Future (Phase 2+)\n- Remove global hotkey registration if Shade handles it\n- Remove context gathering if Shade handles it\n- Vision/OCR integration hooks\n\n## XDG Paths\nHammerspoon will write context to:\n~/.local/state/shade/context.json","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-07T09:06:35.362099-05:00","updated_at":"2026-01-07T09:06:35.362099-05:00"}
{"id":"shade-8g2.1","title":"Rename interop/meganote.lua to interop/shade.lua and update all references","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T10:09:21.282408-05:00","updated_at":"2026-01-07T10:19:33.460276-05:00","closed_at":"2026-01-07T10:19:33.460276-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-8g2.1","depends_on_id":"shade-8g2","type":"parent-child","created_at":"2026-01-07T10:09:21.286033-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8g2.10","title":"[Validate] Test socket path coordination - verify Option A works or need Option B","description":"Socket coordination question from planning session:\n\n**Option A (current approach)**: Hammerspoon passes command with --listen ~/.local/state/shade/nvim.sock\n**Option B (alternative)**: Shade injects --listen into whatever command is passed\n\nWe're starting with Option A. This task is to verify:\n1. Does nvim actually listen on the socket when launched this way?\n2. Can Shade's NvimRPC successfully communicate with it?\n3. If not, do we need Option B (Shade handles socket setup)?\n\nContext: Shade expects socket at StateDirectory.nvimSocketPath (~/.local/state/shade/nvim.sock)\nThe command passed from Hammerspoon needs to include: nvim --listen ~/.local/state/shade/nvim.sock","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-07T10:09:29.291451-05:00","updated_at":"2026-01-08T14:58:50.398123-05:00","closed_at":"2026-01-08T14:58:50.398128-05:00","dependencies":[{"issue_id":"shade-8g2.10","depends_on_id":"shade-8g2","type":"parent-child","created_at":"2026-01-07T10:09:29.292073-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8g2.11","title":"Shade: subsequent daily note presses open empty nvim","description":"When pressing Hyper+Shift+O multiple times:\n1. First press works - opens daily note in Shade\n2. User does :wq or hides Shade\n3. Second press opens empty nvim instead of daily note\n\nNeed to investigate:\n- Is nvim still running after hide? (should be)\n- Is socket still valid?\n- Is openFile() RPC succeeding?\n- Is the issue in Hammerspoon or Shade?\n\nPossibly related to socket cleanup or backgrounding logic.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-07T14:30:02.193339-05:00","updated_at":"2026-01-07T15:03:19.757784-05:00","closed_at":"2026-01-07T15:03:19.757786-05:00","dependencies":[{"issue_id":"shade-8g2.11","depends_on_id":"shade-8g2","type":"parent-child","created_at":"2026-01-07T14:30:02.19414-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8g2.12","title":"Shade: restore focus to previous window on hide","description":"When Shade panel hides (via toggle, hide IPC, or Cmd+Escape):\n- Should restore focus to the window that was focused before Shade was shown\n- Currently just calls orderOut(nil) which leaves focus in limbo\n\nImplementation needed in Shade (Swift):\n- Track previous app/window before showing panel\n- Restore focus to it on hide\n\nThis affects both capture and daily note workflows - user expects to return to their previous context after dismissing Shade.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-07T14:30:09.739725-05:00","updated_at":"2026-01-07T14:30:09.739725-05:00","dependencies":[{"issue_id":"shade-8g2.12","depends_on_id":"shade-8g2","type":"parent-child","created_at":"2026-01-07T14:30:09.740408-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8g2.2","title":"Update IPC notifications from com.meganote.* to io.shade.*","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T10:09:22.026199-05:00","updated_at":"2026-01-07T10:19:33.530097-05:00","closed_at":"2026-01-07T10:19:33.530097-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-8g2.2","depends_on_id":"shade-8g2","type":"parent-child","created_at":"2026-01-07T10:09:22.026943-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8g2.3","title":"Update binary paths and process detection for shade","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T10:09:23.044817-05:00","updated_at":"2026-01-07T10:19:33.597402-05:00","closed_at":"2026-01-07T10:19:33.597402-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-8g2.3","depends_on_id":"shade-8g2","type":"parent-child","created_at":"2026-01-07T10:09:23.045483-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8g2.4","title":"Update socket path to ~/.local/state/shade/nvim.sock","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T10:09:24.078221-05:00","updated_at":"2026-01-07T10:19:43.932244-05:00","closed_at":"2026-01-07T10:19:43.932244-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-8g2.4","depends_on_id":"shade-8g2","type":"parent-child","created_at":"2026-01-07T10:09:24.078807-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8g2.5","title":"Add io.shade.note.capture handler (write context.json, send notification)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T10:09:25.579264-05:00","updated_at":"2026-01-07T10:19:44.041404-05:00","closed_at":"2026-01-07T10:19:44.041404-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-8g2.5","depends_on_id":"shade-8g2","type":"parent-child","created_at":"2026-01-07T10:09:25.579989-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8g2.6","title":"Add io.shade.note.daily handler","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T10:09:26.090667-05:00","updated_at":"2026-01-07T10:19:44.11025-05:00","closed_at":"2026-01-07T10:19:44.11025-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-8g2.6","depends_on_id":"shade-8g2","type":"parent-child","created_at":"2026-01-07T10:09:26.091309-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8g2.7","title":"Update keybindings to use shade module","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T10:09:26.57389-05:00","updated_at":"2026-01-07T10:19:44.180711-05:00","closed_at":"2026-01-07T10:19:44.180711-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-8g2.7","depends_on_id":"shade-8g2","type":"parent-child","created_at":"2026-01-07T10:09:26.574469-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8g2.8","title":"Update notes.lua to use new shade module","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T10:09:27.076615-05:00","updated_at":"2026-01-07T10:19:44.252656-05:00","closed_at":"2026-01-07T10:19:44.252656-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-8g2.8","depends_on_id":"shade-8g2","type":"parent-child","created_at":"2026-01-07T10:09:27.077216-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8g2.9","title":"Rename MEGANOTE=1 env var to SHADE=1","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-07T10:09:28.034911-05:00","updated_at":"2026-01-07T10:19:44.322049-05:00","closed_at":"2026-01-07T10:19:44.322049-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-8g2.9","depends_on_id":"shade-8g2","type":"parent-child","created_at":"2026-01-07T10:09:28.035547-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8nx","title":"Migrate note system to obsidian.nvim-native workflows","description":"Migrate daily notes, quick capture, and task management from shell scripts + Hammerspoon to obsidian.nvim-native templates and Lua functions.\n\n## Progress Summary (as of 2026-01-07)\n\n### COMPLETED\n- [x] Templates created at $NOTES_HOME/templates/ (daily.md, capture-text.md, capture-image.md)\n- [x] obsidian.nvim config updated with custom substitutions:\n  - migrated_tasks: extracts incomplete tasks from previous daily note\n  - yesterday_link: generates link to previous daily note  \n  - capture_context: builds collapsible callout with app/url/file context\n  - capture_selection: wraps selection in code fence with detected language\n  - date_id, timestamp: date formatting helpers\n- [x] Obsidian app configured to match nvim (daily-notes.json, templates.json)\n- [x] Context injection reads from ~/.local/state/shade/context.json\n\n### REMAINING\n- [ ] shade-8nx.5: Update Hammerspoon to use :ObsidianToday and :ObsidianNew commands\n- [ ] shade-8nx.7: Migrate notes from old vault (_notes 2) to new vault (_notes)\n- [ ] shade-8nx.6: Deprecate daily_note shell script\n\n## Key Files Modified\n- config/nvim/lua/plugins/obsidian.lua - Template substitutions and config\n- $NOTES_HOME/templates/daily.md - Daily note template\n- $NOTES_HOME/templates/capture-text.md - Text capture template  \n- $NOTES_HOME/templates/capture-image.md - Image capture template\n- $NOTES_HOME/.obsidian/daily-notes.json - Obsidian app daily notes config\n- $NOTES_HOME/.obsidian/templates.json - Obsidian app templates config\n\n## Architecture Notes\n- Shade writes context.json before triggering capture\n- obsidian.nvim substitutions read context.json at template insertion time\n- Capture linking to daily note handled by BufWritePost autocmd in autocmds.lua:779-838\n- ## Captures section created dynamically on first capture (not in template)","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-07T14:48:48.653865-05:00","updated_at":"2026-01-07T15:18:49.654071-05:00"}
{"id":"shade-8nx.1","title":"Create templates directory and base templates in vault","description":"Create $NOTES_HOME/templates/ directory with:\n- daily.md - Daily note template with frontmatter and sections\n- capture-text.md - Text capture template with context placeholders\n- capture-image.md - Image capture template with OCR placeholder\n\nTemplates should use obsidian.nvim's {{date}}, {{title}} built-ins plus custom substitutions.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T14:50:52.796939-05:00","updated_at":"2026-01-07T14:51:44.894679-05:00","closed_at":"2026-01-07T14:51:44.894679-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-8nx.1","depends_on_id":"shade-8nx","type":"parent-child","created_at":"2026-01-07T14:50:52.797823-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8nx.2","title":"Implement task migration substitution function","description":"Add custom template substitution to obsidian.nvim config for task migration:\n\ntemplates.substitutions = {\n  migrated_tasks = function()\n    -- Find yesterday's daily note\n    -- Extract incomplete tasks (- [ ])\n    -- Return formatted task list\n  end\n}\n\nMust handle edge cases: no previous note, no tasks, weekend gaps.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T14:50:54.110352-05:00","updated_at":"2026-01-07T14:53:44.051526-05:00","closed_at":"2026-01-07T14:53:44.051526-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-8nx.2","depends_on_id":"shade-8nx","type":"parent-child","created_at":"2026-01-07T14:50:54.111779-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8nx.3","title":"Add context injection substitution for captures","description":"Add substitutions that read from Shade's context.json:\n\n- context_source - Browser URL or file path\n- context_app - Source application name\n- context_title - Window/tab title\n- context_selection - Selected text (for text captures)\n\nRead from ~/.local/state/shade/context.json","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T14:50:55.206417-05:00","updated_at":"2026-01-07T14:53:44.202593-05:00","closed_at":"2026-01-07T14:53:44.202593-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-8nx.3","depends_on_id":"shade-8nx","type":"parent-child","created_at":"2026-01-07T14:50:55.20759-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8nx.4","title":"Update obsidian.nvim config with new templates and substitutions","description":"Update config/nvim/lua/plugins/obsidian.lua:\n\n1. Set templates.folder = 'templates'\n2. Set daily_notes.template = 'daily.md'\n3. Add all custom substitutions\n4. Ensure frontmatter.func preserves custom fields","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T14:50:56.430788-05:00","updated_at":"2026-01-07T14:53:44.127491-05:00","closed_at":"2026-01-07T14:53:44.127491-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-8nx.4","depends_on_id":"shade-8nx","type":"parent-child","created_at":"2026-01-07T14:50:56.431671-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8nx.5","title":"Update Hammerspoon to use obsidian.nvim commands","description":"Update lib/interop/shade.lua and lib/notes.lua to use obsidian.nvim commands instead of direct file creation.\n\n## What's Done\n- obsidian.nvim config updated with custom template substitutions\n- Templates created at $NOTES_HOME/templates/ (daily.md, capture-text.md, capture-image.md)\n- Obsidian app configured to match (daily-notes.json, templates.json)\n\n## What Needs to Change\n\n### lib/interop/shade.lua\n- Daily note handler: Send `:ObsidianToday` via nvim RPC instead of running daily_note script\n- The template substitutions (migrated_tasks, yesterday_link) handle task migration automatically\n\n### lib/notes.lua  \n- Text capture: Instead of creating file directly, use `:ObsidianNew` with capture-text template\n- Image capture: Instead of creating file directly, use `:ObsidianNew` with capture-image template\n- The capture_context and capture_selection substitutions read from ~/.local/state/shade/context.json\n- Daily note linking is handled by nvim autocmd on BufWritePost (config/nvim/lua/config/autocmds.lua:779-838)\n\n### Key Files\n- config/hammerspoon/lib/interop/shade.lua\n- config/hammerspoon/lib/notes.lua\n- config/nvim/lua/plugins/obsidian.lua (already updated)\n- config/nvim/lua/config/autocmds.lua (capture linking autocmd exists)\n\n## Testing\n1. Trigger daily note via Shade - should open today's note with migrated tasks\n2. Text capture with selection - should create note with context callout\n3. Image capture - should create note with image embed\n4. Verify captures appear in daily note's ## Captures section","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T14:50:57.75774-05:00","updated_at":"2026-01-07T16:12:47.250991-05:00","closed_at":"2026-01-07T16:12:47.250991-05:00","close_reason":"Implemented and tested. All three workflows verified:\n1. Daily note (:ObsidianToday) - creates/opens daily note at correct path\n2. Text capture (:Obsidian new_from_template capture-text) - zettel+descriptor filename, code block with selection, collapsible context callout\n3. Image capture (:Obsidian new_from_template capture-image) - reads imageFilename from context.json, embeds image, context callout\n\nNote: Full interactive testing blocked by Shade shift-key bug (shade-s7p), but nvim server tests confirm the obsidian.nvim integration works correctly.","dependencies":[{"issue_id":"shade-8nx.5","depends_on_id":"shade-8nx","type":"parent-child","created_at":"2026-01-07T14:50:57.758979-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8nx.6","title":"Deprecate daily_note shell script","description":"After migration is tested:\n\n1. Remove bin/daily_note or rename to daily_note.deprecated\n2. Update any remaining references\n3. Document new workflow in README or notes","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-07T14:50:58.699578-05:00","updated_at":"2026-01-07T14:51:06.341259-05:00","dependencies":[{"issue_id":"shade-8nx.6","depends_on_id":"shade-8nx","type":"parent-child","created_at":"2026-01-07T14:50:58.700432-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8nx.7","title":"Migrate notes from old vault to new format","description":"Migrate notes from ~/iclouddrive/Documents/_notes 2 to ~/iclouddrive/Documents/_notes\n\n## Source (old vault)\n- Path: ~/iclouddrive/Documents/_notes 2\n- Daily notes: daily/YYYY-MM-DD.md (flat, with dashes)\n- Captures: captures/*.md\n- Assets: assets/*\n- Other notes: *.md in root\n\n## Target (new vault)\n- Path: ~/iclouddrive/Documents/_notes\n- Daily notes: daily/YYYY/YYYYMMDD.md (year subfolder, no dashes)\n- Captures: captures/*.md (same)\n- Assets: assets/* (same)\n- Templates: templates/*.md (new)\n\n## Migration steps\n1. Copy assets/ directory\n2. Copy captures/ directory\n3. Migrate daily notes:\n   - Rename YYYY-MM-DD.md -\u003e YYYYMMDD.md\n   - Move into year subfolders (daily/YYYY/)\n   - Update frontmatter id format if present\n   - Update internal links to daily notes\n4. Copy other root-level .md files (ADHD.md, ENG.md, etc.)\n5. Copy .obsidian/ config and update daily-notes.json to match new format\n6. Verify all wiki links still resolve\n7. Remove old vault after verification","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-07T15:16:12.017299-05:00","updated_at":"2026-01-07T15:16:12.017299-05:00","dependencies":[{"issue_id":"shade-8nx.7","depends_on_id":"shade-8nx","type":"parent-child","created_at":"2026-01-07T15:16:12.018256-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-8nx.8","title":"Update image capture template to read imageFilename from context.json","description":"The image_filename substitution in obsidian.lua currently returns a literal placeholder. Update it to:\n\n1. Read imageFilename from ~/.local/state/shade/context.json\n2. Hammerspoon (clipper.lua) should write imageFilename to context.json before triggering capture\n3. Template will then properly embed the image with ![[filename.png]]\n\nThis mirrors how capture_context already works - reading from the shared context file.\n\nRelated: The capture_context substitution already renders as a collapsible callout, so image captures will get the same treatment as text captures for source metadata.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-07T15:42:46.838107-05:00","updated_at":"2026-01-07T15:42:53.529796-05:00","dependencies":[{"issue_id":"shade-8nx.8","depends_on_id":"shade-8nx","type":"parent-child","created_at":"2026-01-07T15:42:46.838825-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq","title":"AI Systems Refactor: Orchestration, Skills, Agents, and Secure Remote Communication","description":"Deep refactor of AI configuration systems (.dotfiles AI infrastructure) to establish:\n\n1. **'dots' Orchestrator** - Central agent that understands the entire dotfiles ecosystem and auto-routes to specialized skills/agents\n2. **Auto-routing** - Automatic detection and delegation based on keywords (nix, hammerspoon, nvim, tmux, shade, etc.)\n3. **Specialized Skills \u0026 Agents** - Deep expertise modules for each subsystem\n4. **Secure Telegram Integration** - Real-time bidirectional communication for remote monitoring and interaction\n5. **Token Efficiency** - Reduce context bloat, improve precision, eliminate hallucinations\n6. **Cross-tool Compatibility** - Works with both claude-code and opencode\n\nResearch areas:\n- Anthropic best practices for skills/agents\n- OpenCode documentation and patterns\n- Community discoveries (X/Twitter, GitHub)\n- MCP ecosystem patterns\n- Prompt engineering research\n- Real-world production setups\n- Telegram bot security best practices","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-08T14:28:53.189939-05:00","updated_at":"2026-01-08T14:28:53.189939-05:00"}
{"id":"shade-alq.1","title":"Research: Anthropic claude-code best practices for skills, agents, and memory","description":"Deep dive into Anthropic's documentation and community patterns for:\n- Skill file structure and content optimization\n- Agent definition best practices\n- Memory system usage patterns\n- Token efficiency strategies\n- When to use skills vs agents vs inline instructions\n\nSources: Anthropic docs, GitHub claude-code issues/discussions, community examples","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T14:29:03.583289-05:00","updated_at":"2026-01-08T15:05:01.533451-05:00","closed_at":"2026-01-08T15:05:01.533457-05:00","dependencies":[{"issue_id":"shade-alq.1","depends_on_id":"shade-alq","type":"parent-child","created_at":"2026-01-08T14:29:03.583924-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.10","title":"Enhance /preview command with smart content rendering","description":"Improve the /preview command to be smarter about content rendering:\n\n## Current State\n- Simple fish -c wrapper showing raw command output in tmux pane\n- No markdown conversion for beads\n- Basic content type routing\n\n## Future Improvements\n- [ ] Convert beads JSON to proper markdown (headers, tables, linked deps)\n- [ ] Open markdown content in nvim for full tooling\n- [ ] Smart pane reuse (check for existing preview panes)\n- [ ] Image preview with kitty/sixel graphics protocol\n- [ ] Syntax highlighting for diff output (delta integration)\n- [ ] JSON pretty-printing with jq + bat\n- [ ] Context memory - remember last previewed item\n\n## Related\n- /preview command: docs/commands/preview.md\n- tmux skill: docs/skills/tmux.md","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-09T11:22:19.043415-05:00","updated_at":"2026-01-09T11:22:19.043415-05:00","dependencies":[{"issue_id":"shade-alq.10","depends_on_id":"shade-alq","type":"parent-child","created_at":"2026-01-09T11:22:19.044383-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.2","title":"Research: OpenCode architecture, skills, agents, and MCP integration","description":"Deep dive into OpenCode's documentation and implementation:\n- Skill file format differences from claude-code\n- Agent spawning patterns\n- MCP server integration\n- Custom tool development\n- Configuration best practices\n\nSources: OpenCode GitHub repo, docs, issues, community examples","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T14:29:13.272571-05:00","updated_at":"2026-01-08T15:05:01.593349-05:00","closed_at":"2026-01-08T15:05:01.593352-05:00","dependencies":[{"issue_id":"shade-alq.2","depends_on_id":"shade-alq","type":"parent-child","created_at":"2026-01-08T14:29:13.27323-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.3","title":"Research: Secure Telegram bot integration for AI agent communication","description":"Research secure patterns for bidirectional Telegram integration:\n- Telegram Bot API security best practices\n- Self-hosted vs cloud options\n- Authentication and authorization patterns\n- Session management for multiple concurrent AI sessions\n- End-to-end encryption considerations\n- Rate limiting and abuse prevention\n- Integration with existing ntfy notification system\n\nGoal: Enable remote monitoring and interaction with AI agents via Telegram while maintaining security","status":"in_progress","priority":1,"issue_type":"task","created_at":"2026-01-08T14:29:19.940552-05:00","updated_at":"2026-01-08T15:01:16.625074-05:00","dependencies":[{"issue_id":"shade-alq.3","depends_on_id":"shade-alq","type":"parent-child","created_at":"2026-01-08T14:29:19.941221-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.4","title":"Research: Community patterns and production setups (Twitter/X, GitHub, forums)","description":"Gather real-world patterns from:\n- Twitter/X discussions about claude-code, cursor, windsurf, aider setups\n- GitHub repos with advanced AI tool configurations\n- Reddit r/LocalLLaMA, r/ChatGPT discussions\n- Discord communities\n- Blog posts and tutorials\n\nFocus on:\n- Token reduction strategies\n- Hallucination prevention\n- Context management\n- Multi-agent orchestration patterns\n- Real production configurations","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-08T14:29:26.089794-05:00","updated_at":"2026-01-08T14:29:26.089794-05:00","dependencies":[{"issue_id":"shade-alq.4","depends_on_id":"shade-alq","type":"parent-child","created_at":"2026-01-08T14:29:26.090466-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.5","title":"Design: 'dots' orchestrator architecture and auto-routing system","description":"Based on research findings, design the orchestrator system:\n- Central 'dots' agent/skill that understands dotfiles ecosystem\n- Auto-routing logic for keyword detection (nix, hammerspoon, nvim, etc.)\n- Delegation patterns to specialized agents\n- Fallback behaviors\n- Integration with both claude-code and opencode\n\nDeliverable: Architecture document and implementation plan","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T14:29:31.818971-05:00","updated_at":"2026-01-09T11:33:43.858853-05:00","closed_at":"2026-01-09T10:57:54.842168-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-alq.5","depends_on_id":"shade-alq","type":"parent-child","created_at":"2026-01-08T14:29:31.819586-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.6","title":"Audit: Current ai.nix, skills, agents - identify bloat and inefficiencies","description":"Analyze current AI configuration for:\n- Redundant instructions across files\n- Overly verbose content consuming tokens\n- Missing critical guidance that causes errors\n- Inconsistencies between claude-code and opencode configs\n- Skills that should be agents (or vice versa)\n- Memory/context that could be externalized\n\nDeliverable: Audit report with specific recommendations","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T14:29:38.650876-05:00","updated_at":"2026-01-08T15:26:48.362107-05:00","closed_at":"2026-01-08T15:26:48.362107-05:00","close_reason":"Audit complete. Findings: memory.text ~2500 tokens (should be 500-800), duplicated content (ntfy, fd/rg), missing skills (cli-tools, jj, image-handling), hammerspoon-expert agent not wired up, OpenCode skills gap. Recommendations feed into alq.7 and alq.9.","dependencies":[{"issue_id":"shade-alq.6","depends_on_id":"shade-alq","type":"parent-child","created_at":"2026-01-08T14:29:38.651616-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.7","title":"Create specialized skills: hammerspoon, nvim, tmux, shade","description":"Create deep-knowledge skills for key subsystems:\n- hammerspoon skill (Lua, macOS APIs, our specific config patterns)\n- nvim skill (our plugin setup, keybindings, LSP config)\n- tmux skill (our session management, layouts)\n- shade skill (Swift, notification patterns, nvim RPC)\n\nEach skill should be:\n- Concise but comprehensive\n- Include our specific patterns and conventions\n- Cross-reference related systems\n- Optimized for token efficiency","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T14:29:44.776476-05:00","updated_at":"2026-01-09T11:33:43.860164-05:00","closed_at":"2026-01-09T10:57:58.733548-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-alq.7","depends_on_id":"shade-alq","type":"parent-child","created_at":"2026-01-08T14:29:44.77716-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.7.1","title":"Create cli-tools skill (fd, rg usage for Nix store searches)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:27:10.09808-05:00","updated_at":"2026-01-08T15:44:01.281605-05:00","closed_at":"2026-01-08T15:44:01.281605-05:00","close_reason":"Created docs/skills/cli-tools.md with fd/rg usage guide","dependencies":[{"issue_id":"shade-alq.7.1","depends_on_id":"shade-alq.7","type":"parent-child","created_at":"2026-01-08T15:27:10.099012-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.7.10","title":"Audit nix.md agent - verify accuracy and effectiveness","description":"Review docs/agents/nix.md for:\n- Accuracy of exploration strategies\n- Effectiveness when spawned as subagent\n- Alignment with dotfiles structure\n- Token efficiency (278 lines)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:48:18.496659-05:00","updated_at":"2026-01-08T16:12:13.536838-05:00","closed_at":"2026-01-08T16:12:13.536838-05:00","close_reason":"Audited nix.md agent - fixed directory structure to show ai/ subdirectory","dependencies":[{"issue_id":"shade-alq.7.10","depends_on_id":"shade-alq.7","type":"parent-child","created_at":"2026-01-08T15:48:18.497442-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.7.11","title":"Audit hammerspoon-expert.md agent - verify accuracy and effectiveness","description":"Review docs/agents/hammerspoon-expert.md for:\n- Accuracy of Hammerspoon patterns and debugging\n- Alignment with config/hammerspoon/ structure\n- Effectiveness when spawned as subagent\n- Token efficiency (195 lines)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:48:20.001432-05:00","updated_at":"2026-01-08T16:12:56.743296-05:00","closed_at":"2026-01-08T16:12:56.743296-05:00","close_reason":"Audited hammerspoon-expert.md agent - updated lib/interop/ listing to reflect actual files, marked deprecated modules","dependencies":[{"issue_id":"shade-alq.7.11","depends_on_id":"shade-alq.7","type":"parent-child","created_at":"2026-01-08T15:48:20.002038-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.7.2","title":"Create jj skill (Jujutsu workflow, commands, workspace patterns)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:27:10.652666-05:00","updated_at":"2026-01-08T15:44:01.352182-05:00","closed_at":"2026-01-08T15:44:01.352182-05:00","close_reason":"Created docs/skills/jj.md with Jujutsu workflow guide","dependencies":[{"issue_id":"shade-alq.7.2","depends_on_id":"shade-alq.7","type":"parent-child","created_at":"2026-01-08T15:27:10.653342-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.7.3","title":"Create image-handling skill (resize-image, API constraints)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:27:11.226514-05:00","updated_at":"2026-01-08T15:44:01.420223-05:00","closed_at":"2026-01-08T15:44:01.420223-05:00","close_reason":"Created docs/skills/image-handling.md with resize-image guide","dependencies":[{"issue_id":"shade-alq.7.3","depends_on_id":"shade-alq.7","type":"parent-child","created_at":"2026-01-08T15:27:11.227332-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.7.4","title":"Wire up hammerspoon-expert agent in ai.nix","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:27:11.892588-05:00","updated_at":"2026-01-08T15:44:01.489205-05:00","closed_at":"2026-01-08T15:44:01.489205-05:00","close_reason":"Wired up hammerspoon-expert.md as agent in claude-code.nix","dependencies":[{"issue_id":"shade-alq.7.4","depends_on_id":"shade-alq.7","type":"parent-child","created_at":"2026-01-08T15:27:11.893211-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.7.5","title":"Create hammerspoon skill (inline guidance, distinct from agent)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:27:12.387032-05:00","updated_at":"2026-01-09T11:33:43.861381-05:00","closed_at":"2026-01-09T10:57:54.860797-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-alq.7.5","depends_on_id":"shade-alq.7","type":"parent-child","created_at":"2026-01-08T15:27:12.387693-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.7.6","title":"Audit nix.md skill - verify accuracy, completeness, best practices","description":"Review docs/skills/nix.md for:\n- Accuracy of commands and examples\n- Completeness of common workflows\n- Best practices alignment\n- Token efficiency (543 lines may be too long)\n- Cross-reference with actual dotfiles patterns","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:48:04.940632-05:00","updated_at":"2026-01-08T16:08:39.601305-05:00","closed_at":"2026-01-08T16:08:39.601305-05:00","close_reason":"Audited nix.md skill - updated directory structure to show ai/ subdirectory. All helpers verified accurate.","dependencies":[{"issue_id":"shade-alq.7.6","depends_on_id":"shade-alq.7","type":"parent-child","created_at":"2026-01-08T15:48:04.941669-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.7.7","title":"Audit smart-ntfy.md skill - verify accuracy, completeness, best practices","description":"Review docs/skills/smart-ntfy.md for:\n- Accuracy of ntfy script options and examples\n- Completeness of notification workflows\n- Alignment with actual ~/bin/ntfy implementation\n- Token efficiency (240 lines)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:48:06.415534-05:00","updated_at":"2026-01-08T16:09:55.609793-05:00","closed_at":"2026-01-08T16:09:55.609793-05:00","close_reason":"Audited smart-ntfy.md skill - all claims verified accurate against ~/bin/ntfy and hammerspoon notification modules","dependencies":[{"issue_id":"shade-alq.7.7","depends_on_id":"shade-alq.7","type":"parent-child","created_at":"2026-01-08T15:48:06.416227-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.7.8","title":"Audit web-debug.md skill - verify accuracy, completeness, best practices","description":"Review docs/skills/web-debug.md for:\n- Accuracy of Chrome DevTools MCP patterns\n- Completeness of debugging workflows\n- Best practices for browser automation\n- Token efficiency (447 lines may be too long)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:48:07.723052-05:00","updated_at":"2026-01-08T16:10:45.945071-05:00","closed_at":"2026-01-08T16:10:45.945071-05:00","close_reason":"Audited web-debug.md skill - patterns are accurate, tool names are conceptual (MCP handles actual prefixes). Minor note: port 9222 mention may be outdated but harmless.","dependencies":[{"issue_id":"shade-alq.7.8","depends_on_id":"shade-alq.7","type":"parent-child","created_at":"2026-01-08T15:48:07.723773-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.7.9","title":"Audit shade.md skill - verify accuracy, completeness, best practices","description":"Review docs/skills/shade.md for:\n- Accuracy of Shade IPC/notification patterns\n- Alignment with current Shade implementation\n- Completeness of debugging workflows\n- Cross-reference with hammerspoon shade.lua","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:48:09.257253-05:00","updated_at":"2026-01-08T16:11:43.407691-05:00","closed_at":"2026-01-08T16:11:43.407691-05:00","close_reason":"Audited shade.md skill - fixed M.capture() to M.captureWithContext(), added missing functions","dependencies":[{"issue_id":"shade-alq.7.9","depends_on_id":"shade-alq.7","type":"parent-child","created_at":"2026-01-08T15:48:09.257832-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.8","title":"Implement Telegram bot bridge for AI agent communication","description":"Based on research findings, implement secure Telegram integration:\n- Bot setup and configuration\n- Bridge service (likely a small daemon)\n- Session tracking for multiple concurrent AI sessions\n- Integration with ntfy for unified notification routing\n- Security hardening\n- Nix packaging for the service\n\nDeliverable: Working Telegram bot that enables bidirectional AI communication","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-08T14:29:50.814787-05:00","updated_at":"2026-01-08T14:29:50.814787-05:00","dependencies":[{"issue_id":"shade-alq.8","depends_on_id":"shade-alq","type":"parent-child","created_at":"2026-01-08T14:29:50.815456-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.9","title":"Refactor ai.nix for token efficiency and clarity","description":"Based on audit and research:\n- Restructure ai.nix for clarity\n- Extract verbose instructions to skills/agents\n- Optimize memory.text for token efficiency\n- Ensure consistency between claude-code and opencode\n- Add safeguards against common mistakes (push without permission, etc.)\n- Document the new structure\n\nDeliverable: Refactored ai.nix with measurably reduced token usage","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T14:29:56.594108-05:00","updated_at":"2026-01-09T11:33:43.862467-05:00","closed_at":"2026-01-09T10:57:58.751675-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-alq.9","depends_on_id":"shade-alq","type":"parent-child","created_at":"2026-01-08T14:29:56.594828-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.9.1","title":"Trim memory.text - remove duplicated content (ntfy, fd/rg examples)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:27:18.197295-05:00","updated_at":"2026-01-08T15:44:07.028012-05:00","closed_at":"2026-01-08T15:44:07.028012-05:00","close_reason":"Trimmed memory.text from ~174 lines to ~60 lines by extracting to skills","dependencies":[{"issue_id":"shade-alq.9.1","depends_on_id":"shade-alq.9","type":"parent-child","created_at":"2026-01-08T15:27:18.198005-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.9.2","title":"Ensure OpenCode reads shared skills from .claude/skills/","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:27:19.53211-05:00","updated_at":"2026-01-09T11:33:43.863609-05:00","closed_at":"2026-01-09T10:57:54.878998-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-alq.9.2","depends_on_id":"shade-alq.9","type":"parent-child","created_at":"2026-01-08T15:27:19.533088-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-alq.9.3","title":"Update ai.nix skill references to use new extracted skills","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:27:20.150594-05:00","updated_at":"2026-01-09T11:33:43.864676-05:00","closed_at":"2026-01-09T10:57:54.897794-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-alq.9.3","depends_on_id":"shade-alq.9","type":"parent-child","created_at":"2026-01-08T15:27:20.151369-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-cgn.1","title":"Setup Ollama with optimal models for M2 Max","description":"Configure Ollama for local LLM inference on M2 Max (32GB).\n\n## Recommended Models\n\n### For Vision/Multimodal (can see images directly):\n- **llava:13b** - Best quality, fits in 32GB\n- **llava:7b** - Faster, still good\n- **bakllava** - Alternative vision model\n\n### For Text Summarization:\n- **llama3.2:latest** - Excellent for summarization\n- **mistral:latest** - Fast, good quality\n- **phi3:medium** - Compact but capable\n\n## Setup Steps\n1. Ensure ollama runs on login (launchd or nix service)\n2. Pull recommended models: ollama pull llava:13b\n3. Test with sample image\n\n## Nix Integration\nAdd to home-manager or darwin config for auto-start.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-08T17:00:51.26437-05:00","updated_at":"2026-01-08T17:00:51.26437-05:00","dependencies":[{"issue_id":"shade-cgn.1","depends_on_id":"shade-cgn","type":"parent-child","created_at":"2026-01-08T17:00:51.265125-05:00","created_by":"seth","metadata":"{}"},{"issue_id":"shade-cgn.1","depends_on_id":".dotfiles-h0a","type":"blocks","created_at":"2026-01-09T11:33:51.534721-05:00","created_by":"seth","metadata":"{}"},{"issue_id":"shade-cgn.1","depends_on_id":"shade-h0a","type":"blocks","created_at":"2026-01-09T11:33:51.534721-05:00","created_by":"seth","metadata":"{}"},{"issue_id":"shade-cgn.1","depends_on_id":".dotfiles-kjx","type":"blocks","created_at":"2026-01-09T11:33:52.274626-05:00","created_by":"seth","metadata":"{}"},{"issue_id":"shade-cgn.1","depends_on_id":"shade-kjx","type":"blocks","created_at":"2026-01-09T11:33:52.274626-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-d1e","title":"[Nix] Document app installation routing criteria","description":"## Problem\nThree app installation methods with unclear routing:\n1. Homebrew Cask (modules/brew.nix)\n2. mkApp Custom (home/packages.nix customApps)\n3. nixpkgs (home/packages.nix)\n\nExample confusion: Spotify is in nixpkgs but also commented out in brew.nix. Why?\n\n## Solution\nAdd documentation header to modules/brew.nix explaining criteria:\n- MAS: App Store exclusives only\n- Homebrew: Has official cask, standard install\n- mkApp: Needs custom fetch (nightly, beta)\n- nixpkgs: Available in nixpkgs, no special handling\n\nAlso resolve Spotify ambiguity.\n\n## Files to modify\n- EDIT: modules/brew.nix (add documentation header)\n- OPTIONAL: home/packages.nix (add comment)\n\n## Acceptance criteria\n- [ ] Clear routing criteria documented\n- [ ] Spotify anomaly resolved/documented","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T08:00:34.405412-05:00","updated_at":"2026-01-14T08:00:34.405412-05:00","dependencies":[{"issue_id":"shade-d1e","depends_on_id":"shade-795","type":"blocks","created_at":"2026-01-14T08:00:39.638451-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-dmf","title":"Auto-cleanup empty quick capture notes on close","description":"## Problem\nQuick capture creates notes with context metadata (frontmatter, capture callout with app/URL/selection info). If user doesn't write any actual content and closes the buffer, we're left with 'zombie' notes that clutter the vault.\n\n## Requirements\n1. Detect when a capture note has only template content (no user-written text)\n2. Trigger cleanup check on:\n   - Buffer close (BufUnload/BufDelete)\n   - Shade panel hide (via nvim RPC)\n3. Show nvim-native confirmation prompt before deletion\n4. Delete file from filesystem if confirmed\n5. Ensure obsidian.nvim vault database is updated (file removal triggers vault refresh)\n\n## Definition of \"empty\"\nA capture note is empty if it contains ONLY:\n- YAML frontmatter (---...---)\n- Capture context callout (\u003e [!info]- Capture Context...)\n- Capture selection block (if any was captured)\n- Whitespace\n\nIf user added ANY text outside these template elements, the note is NOT empty.\n\n## Implementation location\n- Primary: `config/nvim/after/plugin/notes.lua` (autocmd for buffer close)\n- Secondary: Shade app sends RPC on panel hide to trigger same check\n\n## Technical notes\n- Capture notes are in `captures/` subdirectory\n- Note ID pattern: `YYYYMMDDHHMM-descriptor.md`\n- Template defined in obsidian.nvim config: `capture-text.md`, `capture-image.md`\n- Use `vim.fn.confirm()` or `vim.ui.select()` for confirmation","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-12T09:05:00.007418-05:00","updated_at":"2026-01-12T09:37:49.327725-05:00","closed_at":"2026-01-12T09:37:49.327725-05:00"}
{"id":"shade-e35","title":"Pull recommended Ollama models for M2 Max","description":"Pull the recommended models for image summarization on M2 Max (32GB).\n\n## Recommended Models\n\n### For Vision/Multimodal:\n- llava:13b - Best quality vision model\n- bakllava - Alternative\n\n### For Text Summarization:\n- llama3.2:latest - Great for summarization\n- mistral:latest - Fast, good quality\n\n## Steps\n```bash\nollama pull llava:13b\nollama pull llama3.2:latest\n```\n\n## Note\nCould add a script to ~/bin/ or nix activation to ensure models are pulled on new machines.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T11:33:30.930076-05:00","updated_at":"2026-01-09T11:35:07.514188-05:00","closed_at":"2026-01-09T11:35:07.514188-05:00","close_reason":"Already done - llava:13b and llama3.2:latest already pulled","dependencies":[{"issue_id":"shade-e35","depends_on_id":"shade-h0a","type":"blocks","created_at":"2026-01-09T11:34:16.46148-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-gs0","title":"Remove redundant modal enter/exit from Slack context","description":"Post-refactor cleanup: The Slack context (com.tinyspeck.slackmacgap.lua) still manually calls modal:enter() in start() (line 101-102) and modal:exit() in stop() (line 111), but the context orchestrator now handles this.\n\nThe _modalActive guard prevents harm, but this violates DRY and the centralized modal management principle.\n\nFix: Remove obj.modal:enter() from start() and obj.modal:exit() from stop() in Slack context.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-12T11:06:18.915271-05:00","updated_at":"2026-01-12T11:11:45.941438-05:00","closed_at":"2026-01-12T11:11:45.941438-05:00","close_reason":"Removed redundant modal enter/exit calls - orchestrator handles lifecycle now","dependencies":[{"issue_id":"shade-gs0","depends_on_id":"shade-m1t","type":"blocks","created_at":"2026-01-12T11:06:26.194708-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-h0a","title":"Install Ollama via brew.nix","description":"Add Ollama to homebrew packages in ~/.dotfiles/modules/brew.nix\n\nOllama provides local LLM inference. Needed by Shade for image summarization pipeline (shade-cgn).\n\n## Steps\n1. Add 'ollama' to brew.nix casks\n2. Run just rebuild\n3. Verify: ollama --version","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T11:33:30.681621-05:00","updated_at":"2026-01-09T11:34:59.079948-05:00","closed_at":"2026-01-09T11:34:59.079948-05:00","close_reason":"Already done - Ollama installed via Nix in home/programs/ai/ollama.nix"}
{"id":"shade-ji5","title":"Re-evaluate Spotify auto-pause behavior","description":"# Spotify Auto-Pause - DISABLED\n\nAll `hs.spotify.pause()` calls have been disabled. These were automatically pausing Spotify when entering meetings or recording sessions.\n\n## Disabled Locations\n\n| File | Line | Context |\n|------|------|---------|\n| `watchers/camera.lua` | 222 | `startMeetingMode()` - camera activates for meeting |\n| `contexts/co.detail.mac.lua` | 27 | Detail app launches (screen recording) |\n| `contexts/com.brave.Browser...lua` | 63 | Google Meet PWA launches |\n| `contexts/com.obsproject.obs-studio.lua` | 26 | OBS launches (streaming/recording) |\n\n## Already Commented (unchanged)\n- `contexts/com.github.wez.wezterm.lua:18,29` - menubar spotify toggle\n- `contexts/com.apple.Music.lua:23-24` - Apple Music → Spotify handoff\n- `contexts/com.pop.pop.app.lua:29,35` - Pop video calls\n- `contexts/us.zoom.xos.lua:28` - Zoom meetings\n- `contexts/com.microsoft.teams2.lua:34` - Teams meetings\n\n## Config Entries (not disabled, just definitions)\n- `config.lua:205-207` - Spotify layout definition\n- `config.lua:342` - Spotify grid position\n- `config.lua:351` - Spotify launcher (hyper+p)\n\n## Spotify Context File\n`contexts/com.spotify.client.lua` - NOT disabled. This only handles:\n- Auto-killing Spotify when hidden with no windows (lines 33-39)\n- No `hs.spotify` API calls\n\n## Why Disabled\nUser requested disabling all Spotify interactions. Reasons may include:\n- Spotify not being used anymore\n- Unwanted auto-pause behavior\n- Conflicts with other audio management\n- Simplifying Hammerspoon behavior\n\n## To Re-enable\nSearch for `DISABLED: Spotify interactions disabled` and uncomment the relevant lines.\n\n## Considerations for Re-enabling\n1. **Do you still use Spotify?** If not, keep disabled\n2. **Is auto-pause desired?** Some users find it annoying\n3. **Alternative**: Could use Focus modes or Shortcuts instead\n4. **Per-context control**: May want to enable for some contexts but not others","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-12T13:49:32.087983-05:00","updated_at":"2026-01-12T13:49:32.087983-05:00"}
{"id":"shade-jxw","title":"Fix menubar clear all events not working for malformed (nil) notifications","status":"open","priority":2,"issue_type":"bug","created_at":"2026-01-12T10:05:46.462802-05:00","updated_at":"2026-01-12T10:05:46.462802-05:00","dependencies":[{"issue_id":"shade-jxw","depends_on_id":"shade-2gr","type":"blocks","created_at":"2026-01-12T10:19:03.437097-05:00","created_by":"seth","metadata":"{}"},{"issue_id":"shade-jxw","depends_on_id":"shade-sj4","type":"blocks","created_at":"2026-01-12T10:19:03.511872-05:00","created_by":"seth","metadata":"{}"}]}
{"id":"shade-kcj","title":"[Nix] Create lib/paths.nix - centralize path definitions","description":"## Problem\nPath definitions are duplicated between hosts/megabookpro.nix and home/default.nix:\n- hosts/megabookpro.nix:16-17: `icloud_home`, `proton_home`\n- home/default.nix:15-18: Same paths + `notes_home`, `nvim_db_home`\n\nComment in home/default.nix:14 says \"mirroring hosts/megabookpro.nix\" - acknowledging the DRY violation.\n\n## Solution\nCreate lib/paths.nix with all path definitions, import in both files.\n\n## Files to modify\n- NEW: lib/paths.nix\n- EDIT: hosts/megabookpro.nix (use paths from lib/)\n- EDIT: home/default.nix (use paths from lib/)\n\n## Acceptance criteria\n- [ ] All path definitions in ONE place\n- [ ] Both files import from lib/paths.nix\n- [ ] darwin-rebuild succeeds\n- [ ] Hammerspoon nix_path.lua still generates correctly","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T08:00:34.191152-05:00","updated_at":"2026-01-14T08:00:34.191152-05:00"}
{"id":"shade-kjx","title":"Configure Ollama launchd service for auto-start","description":"Set up Ollama to run on login via homebrew services.\n\n## Steps\n1. After installing ollama cask: brew services start ollama\n2. Or add to launchServices in darwin config\n\n## Goal\nOllama server should be running whenever the machine is on, so Shade can call it for summarization.\n\n## Related\n- shade-cgn.1 depends on this","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T11:33:30.806582-05:00","updated_at":"2026-01-09T11:34:59.875329-05:00","closed_at":"2026-01-09T11:34:59.875329-05:00","close_reason":"Already done - launchd agent configured in ollama.nix with RunAtLoad and KeepAlive"}
{"id":"shade-m1t","title":"Fix titleChanged event causing modal exit in Slack","description":"CRITICAL: The titleChanged event is in BOTH isActivationEvent AND isDeactivationEvent arrays in contexts/init.lua. When Slack updates window title (typing indicators, unread badges), it triggers both activation AND deactivation logic sequentially, causing modal:exit() to be called unexpectedly.\n\nRoot cause: contexts/init.lua lines 11-26\n- titleChanged in activation array (line 16)\n- titleChanged in deactivation array (line 24-25)\n\nFix: Remove titleChanged from deactivation events OR add smarter event handling.","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-12T11:06:18.822365-05:00","updated_at":"2026-01-12T11:11:45.861333-05:00","closed_at":"2026-01-12T11:11:45.861333-05:00","close_reason":"Fixed by adding _bindingsCreated guard to prevent binding accumulation from repeated start() calls triggered by titleChanged events"}
{"id":"shade-nco","title":"Fix Slack context shutdown error (utils.eventString nil)","description":"HS reload shows error in Slack context stop method:\n\n```\nLuaSkin: hs.shutdownCallback: attempt to get length of a nil value\n  utils.lua:301: in function 'utils.eventString'\n  com.tinyspeck.slackmacgap.lua:155: in method 'stop'\n```\n\nThe Slack context's stop() method calls utils.eventString() with a nil value.\n\n## Fix\n- Check what's being passed to utils.eventString in the stop method\n- Add nil guard or fix the source of the nil value\n\n## Validation\n- HS reloads without errors\n- HS shuts down cleanly","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-13T07:43:08.159296-05:00","updated_at":"2026-01-13T08:47:38.865698-05:00","closed_at":"2026-01-13T08:47:38.865698-05:00","close_reason":"Slack context shutdown error - will address separately if it recurs"}
{"id":"shade-pqf","title":"Fix beads persistence - remove global .beads gitignore","description":"The global gitignore at ~/.dotfiles/home/git/gitignore lines 128-129 ignores the entire .beads/ directory:\n\n```\n.beads\n**/.beads\n```\n\nThis breaks beads persistence because:\n1. issues.jsonl (source of truth) is never committed\n2. Issues exist only in local SQLite DB\n3. Issues lost on fresh clone, machine switch, or .beads/ deletion\n\nThe Fix (Option A - Recommended):\nRemove lines 128-129 from ~/.dotfiles/home/git/gitignore\n\nThe .beads/.gitignore inside each repo already handles ignoring SQLite files, daemon files, etc. Only issues.jsonl, interactions.jsonl, config.yaml, and README.md would be tracked.\n\nIntended workflow:\n- Create issue → SQLite updated → Auto-export to issues.jsonl → git commit/push\n- Pull from remote → Auto-import from issues.jsonl → SQLite updated\n\nAfter fix: Run `bd sync` in repos to ensure JSONL files are current, then commit them.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T15:57:12.790633-05:00","updated_at":"2026-01-07T16:00:26.013396-05:00","closed_at":"2026-01-07T16:00:26.013396-05:00","close_reason":"Fixed by removing .beads and **/.beads from global gitignore at home/git/gitignore. Rebuild applied the change. Each repo's .beads/.gitignore handles ignoring SQLite/daemon files while tracking issues.jsonl."}
{"id":"shade-sj4","title":"Add null handling for notification fields in menubar display","description":"## Problem\nNotifications with null/missing fields display as \"nil\" in the menubar instead of graceful fallbacks.\n\n## Current Code in menubar.lua normalizeEvents()\n```lua\nfor _, notif in ipairs(events.focusBlocked) do\n  local sender = notif.sender or \"Unknown\"  -- Works for nil\n  local preview = notif.message and notif.message:sub(1, 40) or \"\"\n  -- ...\n  title = fmt(\"%s: %s\", sender, preview),  -- Can produce \"nil: \" if sender is string \"nil\"\nend\n```\n\n## Impact\n- Users see \"nil (44m ago)\" instead of meaningful fallback text\n- Broken app icon display (shows placeholder image)\n- Poor user experience for malformed notification data\n\n## Fix\n1. Add explicit nil/empty string checks: `local sender = (notif.sender and notif.sender ~= \"\") and notif.sender or \"Unknown\"`\n2. Handle case where app_id is nil/invalid for icon lookup\n3. Consider logging warnings for malformed notifications\n\n## Related\n- Parent bug: shade-jxw (menubar clear all events not working)","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-12T10:18:54.233532-05:00","updated_at":"2026-01-12T10:19:58.961478-05:00","closed_at":"2026-01-12T10:19:58.961478-05:00","close_reason":"Fixed: Added robust null/empty handling for sender, message, and event_type fields"}
{"id":"shade-t7f","title":"Shade: Shift key combinations not passed to terminal","description":"Shift key combinations fail in Shade's embedded terminal:\n- Cannot type ':' (Shift+;) to enter nvim command mode\n- Cannot type 'O' (Shift+o) for new line above\n- All shifted characters appear to fail (?, \", {, etc.)\n\nWorks correctly in:\n- Regular nvim in Ghostty\n- Regular nvim in Kitty\n- Previously worked when Shade used Kitty\n\nLikely cause: Shade's key event handling is not properly passing the Shift modifier to the PTY/terminal emulator.\n\nThis is blocking testing of the obsidian.nvim migration (shade-8nx.5).","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-07T16:07:12.179601-05:00","updated_at":"2026-01-09T11:38:06.707348-05:00","closed_at":"2026-01-09T11:38:06.707348-05:00"}
{"id":"shade-wvu","title":"Fix app context modal keybindings (disabled due to bugs)","description":"# App Context Modal Keybindings - DISABLED\n\nModal keybindings for app contexts (Slack, Teams, etc.) are currently disabled due to unresolved bugs.\n\n## Symptoms Observed\n- Keybindings work initially then stop working after some time\n- Some keys work intermittently (Ctrl+J works, Ctrl+K doesn't)\n- Performance issues / lag reported\n- Behavior inconsistent across sessions\n\n## Root Cause Investigation\n\n### Initial Hypothesis (Partially Correct)\nThe `titleChanged` event was triggering `start()` repeatedly, which was adding duplicate keybindings via `obj.modal:bind()`. This caused binding accumulation and modal state corruption.\n\n### Fix Attempted\n1. Added `_bindingsCreated` guard flag to Slack context to prevent duplicate bindings\n2. Removed redundant `modal:enter()`/`modal:exit()` calls from individual contexts (Slack, Teams)\n3. Centralized modal lifecycle management in `contexts/init.lua` orchestrator\n\n### Result\nFix was incomplete - bindings still failed. The guard prevented accumulation but didn't resolve the underlying issue.\n\n## Architecture Overview\n\n```\nEvent Flow:\n  App Event (activated/deactivated/titleChanged/etc.)\n      ↓\n  watchers/app.lua → runContextForAppBundleID()\n      ↓\n  contexts/init.lua → M:run()\n      ↓\n  ┌─────────────────────────────────────┐\n  │ isActivationEvent(event)?           │\n  │   → modal:enter() (if not active)   │\n  │   → context:start() or onActivate() │\n  ├─────────────────────────────────────┤\n  │ isDeactivationEvent(event)?         │\n  │   → modal:exit() (if active)        │\n  │   → context:stop() or onDeactivate()│\n  └─────────────────────────────────────┘\n```\n\n### Key Files\n| File | Purpose |\n|------|---------|\n| `contexts/init.lua` | Orchestrator - modal enter/exit, event routing |\n| `contexts/com.tinyspeck.slackmacgap.lua` | Slack keybindings (Ctrl+J/K/N/P etc.) |\n| `contexts/com.microsoft.teams2.lua` | Teams context (minimal) |\n| `watchers/app.lua` | App watcher that triggers context runs |\n\n### Event Lists (contexts/init.lua)\n```lua\n-- Activation events (lines 12-17)\nactivationEvents = {\n  hs.application.watcher.activated,\n  hs.application.watcher.launched,\n  hs.uielement.watcher.windowCreated,\n  hs.uielement.watcher.titleChanged,  -- ← Fires frequently in Slack\n  hs.uielement.watcher.applicationActivated,\n}\n\n-- Deactivation events (lines 20-26)\ndeactivationEvents = {\n  hs.application.watcher.terminated,\n  hs.application.watcher.deactivated,\n  hs.uielement.watcher.elementDestroyed,\n  hs.uielement.watcher.titleChanged,  -- ← Also here! (but if/elseif prevents both)\n  hs.uielement.watcher.applicationDeactivated,\n}\n```\n\n## Current State\n- `M.MODALS_ENABLED = false` in contexts/init.lua (line 10)\n- `M.DEBUG = false` (set to true for investigation)\n- Debug logging infrastructure in place\n- Individual context files have debug wrappers (can be removed later)\n\n## To Re-enable and Debug\n1. Set `M.DEBUG = true` in contexts/init.lua\n2. Set `M.MODALS_ENABLED = true` in contexts/init.lua\n3. Reload Hammerspoon\n4. Open Hammerspoon Console (Cmd+Shift+C)\n5. Switch to Slack, use it for a few minutes\n6. Watch for patterns in console output:\n   - `[CTX DEBUG] MODAL EXITED` without switching apps = BUG\n   - `[SLACK KEY]` logs without action = binding issue\n   - No key logs at all = modal not active\n\n## Potential Causes to Investigate\n1. **titleChanged frequency**: Slack changes title constantly (typing indicators, unreads). Even with guards, this triggers context code repeatedly.\n2. **Modal state desync**: `_modalActive` flag may get out of sync with actual modal state\n3. **hs.hotkey.modal quirks**: Hammerspoon's modal system may have edge cases with rapid enter/exit\n4. **Event ordering**: Activation and deactivation events may arrive in unexpected order\n5. **Memory/performance**: Repeated event processing may cause issues\n\n## Related Commits\n- Initial fix attempt: `fix(hs): prevent modal binding accumulation in Slack context`\n- Disabled: `fix(hs): disable app context modals and Spotify interactions`","status":"open","priority":2,"issue_type":"bug","created_at":"2026-01-12T13:00:35.70971-05:00","updated_at":"2026-01-12T13:49:15.475224-05:00"}
{"id":"shade-x2o","title":"Exhaustive audit of AI skills/rules for comprehensive coverage","description":"## Context\n\nThe nix skill was updated to include comprehensive package management guidance after discovering Claude knew 'not to use brew install' but didn't know what to do instead. The skill now has:\n- Decision tree for package installation\n- Step-by-step verification commands\n- Temporary vs permanent installation patterns\n- Flake structure verification\n\n## Task\n\nAudit ALL other skills to ensure they have similar comprehensive coverage:\n\n### Skills to Audit\n- [ ] `jj` - Does it cover ALL common workflows? Edge cases?\n- [ ] `cli-tools` - Does fd/rg guidance cover all search patterns?\n- [ ] `smart-ntfy` - Is routing logic complete?\n- [ ] `image-handling` - Are all constraints documented?\n- [ ] `web-debug` - Chrome DevTools + Playwright patterns?\n- [ ] `shade` - IPC/RPC debugging complete?\n- [ ] `hs` - Hammerspoon patterns comprehensive?\n- [ ] `nvim` - Plugin/LSP patterns complete?\n\n### For Each Skill, Verify\n1. **Decision trees** - Clear 'if X then Y' guidance\n2. **Step-by-step commands** - Copy-pasteable examples\n3. **Verification steps** - How to confirm it worked\n4. **Error handling** - What to do when things fail\n5. **Edge cases** - Unusual scenarios covered\n\n### Rules/memory.text Audit\n- Tool Selection Matrix complete?\n- Skill Loading Requirements has all triggers?\n- Showstopping Violations comprehensive?\n\n## Success Criteria\nEvery skill should be 'trustworthy' - Claude should be able to follow it without guessing or asking user for help on common scenarios.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T09:55:10.579417-05:00","updated_at":"2026-01-09T10:44:39.811126-05:00","closed_at":"2026-01-09T10:44:39.811126-05:00","close_reason":"Comprehensive audit complete. All 9 skills expanded with decision trees, troubleshooting, and self-discovery patterns. memory.text updated with agents/commands documentation. Total expansion: ~3000 lines across all skills."}
