{"id":"shade-141","title":"Shade: Rename MegaNote and implement persistent terminal wrapper","description":"Transform MegaNote into Shade - a lightweight, persistent floating terminal wrapper around libghostty.\n\n## Goals\n- Rename project from MegaNote to Shade (\"lighter than a ghost\")\n- Implement background-on-exit behavior (nvim :wq hides, doesn't quit)\n- Add emergency escape hotkey (independent of Hammerspoon)\n- Support note workflows: quick capture and daily note via IPC\n- Use XDG directories for state files\n- New IPC namespace: io.shade.*\n\n## Non-Goals (Future Phases)\n- Full global hotkey registration (Phase 2)\n- Context gathering in Shade (Phase 2)  \n- Vision/OCR integration (Phase 3)\n- Migrate daily note logic to obsidian.nvim (Phase 3)\n\n## Architecture\n```\n~/.local/state/shade/\n├── context.json    # Capture context from Hammerspoon\n├── nvim.sock       # Nvim RPC socket\n└── shade.pid       # Process management\n\nIPC: io.shade.{toggle,show,hide,quit}\n     io.shade.note.{capture,daily}\n```","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-07T09:02:22.219108-05:00","created_by":"seth","updated_at":"2026-01-07T09:02:22.219108-05:00"}
{"id":"shade-141.1","title":"Rename project: MegaNote → Shade","description":"Comprehensive rename of all project artifacts.\n\n## Changes Required\n- [ ] Rename `Sources/*.swift` types: MegaAppDelegate → ShadeAppDelegate, MegaPanel → ShadePanel\n- [ ] Update Package.swift product name\n- [ ] Update binary name in justfile\n- [ ] Update README.md\n- [ ] Update LICENSE if needed\n- [ ] Update flake.nix package name\n- [ ] Update all IPC notification names: com.meganote.* → io.shade.*\n- [ ] Update Log messages\n- [ ] Update CLI help text and app description\n\n## Verification\n- `just build` succeeds\n- `just run --help` shows 'shade' branding\n- IPC notifications use new namespace","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T09:02:28.85084-05:00","created_by":"seth","updated_at":"2026-01-07T09:21:03.320158-05:00","closed_at":"2026-01-07T09:21:03.320158-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-141.1","depends_on_id":"shade-141","type":"parent-child","created_at":"2026-01-07T09:02:28.851482-05:00","created_by":"seth"}]}
{"id":"shade-141.10","title":"[Future] Phase 2: Move global hotkeys to Shade","description":"Register Hyper+Shift+N and Hyper+Shift+O directly in Shade.\n\n## Goal\nMake Shade fully independent of Hammerspoon for note workflows.\n\n## Scope\n- Register global hotkeys via CGEvent tap\n- Hyper+Shift+N → quick capture (with context gathering)\n- Hyper+Shift+O → daily note\n- Gather context directly in Shade (port get-selection Swift logic)\n\n## Prerequisites\n- shade-141.6 (emergency hotkey) proves CGEvent approach works\n- Accessibility permissions documented\n\n## Considerations\n- Conflicts with Hammerspoon if both register same keys\n- May need config to disable Shade hotkeys if user prefers Hammerspoon\n- Hyper key detection (Cmd+Ctrl+Alt+Shift) in CGEvent\n\n## Defer Until\n- Phase 1 complete and stable\n- User confirms desire to move away from Hammerspoon","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-07T09:03:20.985527-05:00","created_by":"seth","updated_at":"2026-01-07T09:03:20.985527-05:00","dependencies":[{"issue_id":"shade-141.10","depends_on_id":"shade-141","type":"parent-child","created_at":"2026-01-07T09:03:20.986147-05:00","created_by":"seth"}]}
{"id":"shade-141.11","title":"[Future] Phase 2: Context gathering in Shade","description":"Port context gathering from Hammerspoon to Shade.\n\n## Current State\n- get-selection (Swift script) captures selected text via Accessibility API\n- interop/context.lua gathers browser URLs, nvim state, etc.\n- Hammerspoon orchestrates and writes context.json\n\n## Goal\nShade gathers context itself when quick capture is triggered.\n\n## Implementation\n- Port get-selection logic into Shade\n- Add browser URL detection (JXA or Accessibility)\n- Add nvim context via RPC (already needed for shade-141.8)\n- Write context.json for obsidian.nvim template consumption\n\n## Prerequisites\n- shade-141.8 (nvim RPC) complete\n- Phase 2 hotkeys working\n\n## Considerations\n- Accessibility permissions already required\n- May need entitlements for JXA/AppleScript\n- Some context (like browser URL) may require Hammerspoon's hs.application","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-07T09:03:26.605364-05:00","created_by":"seth","updated_at":"2026-01-07T09:03:26.605364-05:00","dependencies":[{"issue_id":"shade-141.11","depends_on_id":"shade-141","type":"parent-child","created_at":"2026-01-07T09:03:26.605992-05:00","created_by":"seth"}]}
{"id":"shade-141.12","title":"[Future] Phase 3: Vision/OCR integration research","description":"Research and implement image-to-text for captured screenshots.\n\n## Goal\nWhen user captures a screenshot, optionally:\n1. Run OCR to extract text\n2. Run Vision/LLM to summarize content\n3. Include in capture note\n\n## Technologies to Research\n- Apple Vision framework (on-device OCR)\n- Ollama with local models (summarization)\n- VLMs for image understanding\n\n## Integration Points\n- Hammerspoon clipper.lua already handles screenshot capture\n- Could add OCR step before/after upload\n- Shade could coordinate OCR if image path passed in context\n\n## Open Questions\n- Should OCR happen in Hammerspoon, Shade, or separate service?\n- Async processing (don't block capture workflow)?\n- How to inject OCR text into note template?\n\n## Defer Until\n- Phase 2 complete\n- obsidian.nvim templating enhanced","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-07T09:03:32.326018-05:00","created_by":"seth","updated_at":"2026-01-07T09:03:32.326018-05:00","dependencies":[{"issue_id":"shade-141.12","depends_on_id":"shade-141","type":"parent-child","created_at":"2026-01-07T09:03:32.326631-05:00","created_by":"seth"}]}
{"id":"shade-141.13","title":"[Future] Phase 3: Migrate daily note logic to obsidian.nvim","description":"Replace shell script daily_note with obsidian.nvim native functionality.\n\n## Current State\n- daily_note shell script handles:\n  - File creation with template\n  - Task migration from previous day\n  - Tmux session management\n- obsidian.nvim has :ObsidianToday but doesn't migrate tasks\n\n## Goal\nUse obsidian.nvim for all daily note functionality:\n- Template-based creation\n- Custom Lua to migrate tasks from previous day\n- No shell script dependency\n\n## Research Required\n- obsidian.nvim template capabilities\n- Hook into note creation event\n- Access previous day's note programmatically\n- Parse and migrate incomplete tasks\n\n## Implementation Ideas\n- obsidian.nvim callback: on_new_daily_note\n- Custom Lua function to find previous note\n- Treesitter to parse task items\n- Append migrated tasks to new note\n\n## Considerations\n- Task format: - [ ] vs - [x]\n- Which sections to migrate?\n- Handle edge cases (no previous note, weekend gaps)\n\n## Defer Until\n- Phase 2 complete\n- Research obsidian.nvim extensibility","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-07T09:03:38.533269-05:00","created_by":"seth","updated_at":"2026-01-07T09:03:38.533269-05:00","dependencies":[{"issue_id":"shade-141.13","depends_on_id":"shade-141","type":"parent-child","created_at":"2026-01-07T09:03:38.534024-05:00","created_by":"seth"}]}
{"id":"shade-141.14","title":"[Future] Native msgpack-rpc client for nvim","description":"Superseded by epic shade-plf - see that epic for detailed breakdown of tasks.","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-07T09:32:36.276013-05:00","created_by":"seth","updated_at":"2026-01-07T15:52:38.947192-05:00","closed_at":"2026-01-07T15:52:38.947192-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-141.14","depends_on_id":"shade-141","type":"parent-child","created_at":"2026-01-07T09:32:36.278186-05:00","created_by":"seth"}]}
{"id":"shade-141.2","title":"Implement background-on-exit behavior","description":"When the child process (nvim) exits normally, hide the panel instead of terminating Shade.\n\n## Current Behavior\n- `TerminalView.hasProcessExited()` triggers `NSApp.terminate()`\n- User must re-launch Shade after every nvim session\n\n## Desired Behavior\n- nvim :wq → hide panel, keep Shade running\n- nvim killed/crashed → hide panel, keep Shade running\n- Cmd+Q in Shade → actually terminate\n- io.shade.quit IPC → actually terminate\n\n## Implementation\n- Remove/modify the termination logic in tick timer\n- On process exit: destroy surface, hide panel, await new surface creation\n- Track 'has active surface' state\n- Add quit notification handler\n\n## Edge Cases\n- Multiple rapid toggles while no surface exists\n- Surface creation failure after process exit","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T09:02:34.314821-05:00","created_by":"seth","updated_at":"2026-01-07T09:23:03.952435-05:00","closed_at":"2026-01-07T09:23:03.952435-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-141.2","depends_on_id":"shade-141","type":"parent-child","created_at":"2026-01-07T09:02:34.31537-05:00","created_by":"seth"}]}
{"id":"shade-141.3","title":"Add XDG directory support for state files","description":"Use XDG Base Directory spec for Shade's runtime state.\n\n## Directory Structure\n```\n~/.local/state/shade/\n├── context.json    # Capture context (written by Hammerspoon)\n├── nvim.sock       # Nvim RPC socket path\n└── shade.pid       # PID file for process management\n```\n\n## Implementation\n- Create StateDirectory helper in Swift\n- Auto-create directory on launch if missing\n- Write PID file on launch, remove on clean shutdown\n- Update nvim socket path in launch command\n- Expose paths via CLI flags or environment for Hammerspoon\n\n## Considerations\n- Handle existing /tmp paths gracefully during transition\n- Document XDG paths in README","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T09:02:38.625725-05:00","created_by":"seth","updated_at":"2026-01-07T09:24:18.365254-05:00","closed_at":"2026-01-07T09:24:18.365254-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-141.3","depends_on_id":"shade-141","type":"parent-child","created_at":"2026-01-07T09:02:38.626362-05:00","created_by":"seth"}]}
{"id":"shade-141.4","title":"Implement io.shade.note.capture IPC handler","description":"Handle quick capture requests from Hammerspoon.\n\n## IPC Flow\n1. Hammerspoon gathers context, writes to ~/.local/state/shade/context.json\n2. Hammerspoon sends io.shade.note.capture notification\n3. Shade reads context.json\n4. Shade shows panel\n5. Shade sends RPC to nvim: open new capture file (or use obsidian.nvim command)\n\n## Context JSON Schema\n```json\n{\n  \"appType\": \"browser|terminal|neovim|other\",\n  \"appName\": \"Brave Browser\",\n  \"windowTitle\": \"GitHub - ...\",\n  \"url\": \"https://...\",\n  \"filePath\": \"/path/to/file\",\n  \"selection\": \"selected text\",\n  \"detectedLanguage\": \"lua\",\n  \"timestamp\": \"2026-01-07T12:00:00Z\"\n}\n```\n\n## Implementation\n- Add notification observer for io.shade.note.capture\n- Read and parse context.json\n- If no surface exists, create one\n- Send nvim RPC command to open capture file\n- Show panel\n\n## Dependencies\n- Requires background-on-exit (surface may not exist)\n- Requires XDG directories (context.json path)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T09:02:44.269753-05:00","created_by":"seth","updated_at":"2026-01-07T09:25:53.087762-05:00","closed_at":"2026-01-07T09:25:53.087762-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-141.4","depends_on_id":"shade-141","type":"parent-child","created_at":"2026-01-07T09:02:44.270385-05:00","created_by":"seth"},{"issue_id":"shade-141.4","depends_on_id":"shade-141.2","type":"blocks","created_at":"2026-01-07T09:03:47.725346-05:00","created_by":"seth"},{"issue_id":"shade-141.4","depends_on_id":"shade-141.3","type":"blocks","created_at":"2026-01-07T09:03:47.763122-05:00","created_by":"seth"}]}
{"id":"shade-141.5","title":"Implement io.shade.note.daily IPC handler","description":"Handle daily note requests from Hammerspoon.\n\n## IPC Flow\n1. Hammerspoon sends io.shade.note.daily notification\n2. Shade shows panel\n3. Shade sends RPC to nvim to open daily note\n\n## Implementation Options\n\n### Option A: Let obsidian.nvim handle it\n- Send nvim RPC: `nvim_command('ObsidianToday')`\n- obsidian.nvim creates file with template if needed\n- Requires obsidian.nvim to be configured for daily notes\n\n### Option B: Shade computes path, nvim just opens\n- Shade computes: `~/notes/daily/2026/20260107.md`\n- Send nvim RPC: `nvim_command('edit ' .. path)`\n- File creation/templating happens elsewhere (shell script still)\n\n## Current Recommendation\n- Start with Option B (matches current workflow)\n- Migrate to Option A when obsidian.nvim templating is enhanced\n\n## Dependencies\n- Requires background-on-exit (surface may not exist)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T09:02:49.408173-05:00","created_by":"seth","updated_at":"2026-01-07T09:25:57.17003-05:00","closed_at":"2026-01-07T09:25:57.17003-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-141.5","depends_on_id":"shade-141","type":"parent-child","created_at":"2026-01-07T09:02:49.408786-05:00","created_by":"seth"},{"issue_id":"shade-141.5","depends_on_id":"shade-141.2","type":"blocks","created_at":"2026-01-07T09:03:47.799844-05:00","created_by":"seth"}]}
{"id":"shade-141.6","title":"Add emergency escape hotkey (Cmd+Escape)","description":"Register a global hotkey as emergency dismiss, independent of Hammerspoon.\n\n## Goal\nWhen Hammerspoon breaks, user can still dismiss Shade with Cmd+Escape (or configured key).\n\n## Implementation Approach\nUse CGEvent tap to register global hotkey:\n1. Request Accessibility permissions (likely already granted for get-selection)\n2. Create CGEvent tap for keyDown events\n3. Check for Cmd+Escape combination\n4. On match: hide panel, return true (consume event)\n\n## Considerations\n- Should this work even when Shade is hidden? (Probably no-op)\n- What if Accessibility permissions denied? (Log warning, continue without hotkey)\n- Should hotkey be configurable? (Future: via config file)\n\n## Alternative: NSEvent.addGlobalMonitorForEvents\n- Simpler API but less reliable for key consumption\n- May not work if another app has captured the key\n\n## Verification\n- Launch Shade\n- Kill Hammerspoon\n- Press Cmd+Escape\n- Shade should hide","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T09:02:55.495287-05:00","created_by":"seth","updated_at":"2026-01-07T09:34:07.129171-05:00","closed_at":"2026-01-07T09:34:07.129171-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-141.6","depends_on_id":"shade-141","type":"parent-child","created_at":"2026-01-07T09:02:55.495917-05:00","created_by":"seth"}]}
{"id":"shade-141.7","title":"Add Cmd+Q handler for actual quit","description":"Distinguish between 'hide on process exit' and 'actually quit the app'.\n\n## Current State\n- No explicit quit handling\n- App quits when child process exits\n\n## Desired Behavior\n- Cmd+Q in Shade window → terminate app\n- io.shade.quit IPC → terminate app\n- Child process exit → hide panel, keep running\n\n## Implementation\n- Add menu bar (even if hidden) with Quit item for Cmd+Q\n- Or: capture Cmd+Q in key event handling\n- Add io.shade.quit notification observer\n- Both trigger NSApp.terminate()\n\n## Considerations\n- Shade runs as .accessory (no dock icon) - does Cmd+Q still work?\n- May need to temporarily become .regular to receive Cmd+Q?\n- Alternative: capture in global hotkey system","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T09:03:00.393904-05:00","created_by":"seth","updated_at":"2026-01-07T09:25:01.1793-05:00","closed_at":"2026-01-07T09:25:01.1793-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-141.7","depends_on_id":"shade-141","type":"parent-child","created_at":"2026-01-07T09:03:00.394451-05:00","created_by":"seth"}]}
{"id":"shade-141.8","title":"Implement nvim RPC communication","description":"Add ability to send commands to nvim via Unix socket RPC.\n\n## Current State\n- nvim launched with: --listen /tmp/nvim-capture.sock\n- Hammerspoon can send RPC commands\n- Shade cannot (no RPC client)\n\n## Required for\n- Opening files in existing nvim session (capture, daily note)\n- Checking buffer state before switching\n- Future: sending save commands\n\n## Implementation\nUse nvim's msgpack-rpc protocol over Unix socket:\n1. Connect to socket at ~/.local/state/shade/nvim.sock\n2. Send nvim_command() RPC calls\n3. Handle connection failures gracefully (nvim not running)\n\n## Swift Options\n- Raw socket + msgpack encoding (complex)\n- Shell out to nvr/nvim --remote (simpler, adds dependency)\n- Use Process to run: nvim --server \u003csock\u003e --remote-send '\u003ccmd\u003e'\n\n## Recommended: Start with Process/nvim --server\n```swift\nProcess.run(\n  \"/usr/bin/env\", \"nvim\",\n  \"--server\", socketPath,\n  \"--remote-send\", \"\u003cC-\\\\\u003e\u003cC-n\u003e:edit \\(path)\u003cCR\u003e\"\n)\n```\n\n## Considerations\n- What if nvim isn't running? Create new surface with nvim\n- What if socket doesn't exist? Same as above\n- Race conditions between surface creation and RPC","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T09:03:08.61901-05:00","created_by":"seth","updated_at":"2026-01-07T09:32:47.882087-05:00","closed_at":"2026-01-07T09:32:47.882087-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-141.8","depends_on_id":"shade-141","type":"parent-child","created_at":"2026-01-07T09:03:08.619622-05:00","created_by":"seth"},{"issue_id":"shade-141.8","depends_on_id":"shade-141.3","type":"blocks","created_at":"2026-01-07T09:03:47.835983-05:00","created_by":"seth"}]}
{"id":"shade-141.9","title":"Update documentation and README for Shade","description":"Comprehensive documentation update after rename.\n\n## Updates Required\n- [ ] README.md: new name, updated architecture diagram\n- [ ] README.md: document XDG paths\n- [ ] README.md: document new IPC namespace\n- [ ] README.md: document emergency hotkey\n- [ ] Update justfile comments\n- [ ] Add CHANGELOG.md entry for rename\n\n## New Sections to Add\n- IPC Protocol reference\n- XDG directory structure\n- Hammerspoon integration guide (link to dotfiles epic)","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-07T09:03:15.591985-05:00","created_by":"seth","updated_at":"2026-01-07T09:35:24.759631-05:00","closed_at":"2026-01-07T09:35:24.759631-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-141.9","depends_on_id":"shade-141","type":"parent-child","created_at":"2026-01-07T09:03:15.592563-05:00","created_by":"seth"}]}
{"id":"shade-plf","title":"Native msgpack-rpc client for nvim","description":"Implement a native Swift msgpack-rpc client to communicate with nvim directly over Unix socket, replacing the current shell-out approach.\n\n## Goals\n- Persistent socket connection to nvim (no process spawn per command)\n- Full access to nvim's 400+ API functions\n- Bidirectional communication: Shade → Nvim AND Nvim → Shade\n- Async notifications for buffer changes, saves, etc.\n\n## Non-Goals (for now)\n- Full UI rendering (that's what VimR does)\n- Replacing ghostty terminal emulation\n\n## Architecture\n```\nShade ←→ Unix Socket ←→ Nvim\n         (msgpack-rpc)\n\n~/.local/state/shade/nvim.sock\n```\n\n## Key Capabilities Unlocked\n1. Call any nvim API function directly\n2. Get return values from nvim\n3. Subscribe to buffer events (nvim_buf_attach)\n4. Know when user saves, changes buffers, etc.\n5. Execute Lua code in nvim context\n6. Read/write buffer content programmatically\n\n## Dependencies\n- MessagePack.swift (a2/MessagePack.swift) or manual encoding\n- Existing Unix socket infrastructure in Shade\n\n## References\n- Nvim API: https://neovim.io/doc/user/api.html\n- Msgpack-RPC spec: https://github.com/msgpack-rpc/msgpack-rpc/blob/master/spec.md\n- VimR NvimApi: https://github.com/qvacua/vimr/tree/master/NvimApi","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-07T15:50:50.44624-05:00","created_by":"seth","updated_at":"2026-01-07T15:50:50.44624-05:00"}
{"id":"shade-plf.1","title":"Add MessagePack.swift dependency via SPM","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T15:51:59.712486-05:00","created_by":"seth","updated_at":"2026-01-07T16:40:13.29822-05:00","closed_at":"2026-01-07T16:40:13.29822-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-plf.1","depends_on_id":"shade-plf","type":"parent-child","created_at":"2026-01-07T15:51:59.713126-05:00","created_by":"seth"}]}
{"id":"shade-plf.2","title":"Implement Unix socket connection manager for nvim","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T15:52:00.330496-05:00","created_by":"seth","updated_at":"2026-01-07T16:46:22.014746-05:00","closed_at":"2026-01-07T16:46:22.014746-05:00","close_reason":"Closed","dependencies":[{"issue_id":"shade-plf.2","depends_on_id":"shade-plf","type":"parent-child","created_at":"2026-01-07T15:52:00.333338-05:00","created_by":"seth"},{"issue_id":"shade-plf.2","depends_on_id":"shade-plf.1","type":"blocks","created_at":"2026-01-07T15:52:08.777686-05:00","created_by":"seth"}]}
{"id":"shade-plf.3","title":"Implement msgpack-rpc protocol encoder/decoder","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T15:52:00.94768-05:00","created_by":"seth","updated_at":"2026-01-07T15:52:00.94768-05:00","dependencies":[{"issue_id":"shade-plf.3","depends_on_id":"shade-plf","type":"parent-child","created_at":"2026-01-07T15:52:00.967753-05:00","created_by":"seth"},{"issue_id":"shade-plf.3","depends_on_id":"shade-plf.1","type":"blocks","created_at":"2026-01-07T15:52:08.847247-05:00","created_by":"seth"}]}
{"id":"shade-plf.4","title":"Implement request/response handling with msgid correlation","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T15:52:01.545189-05:00","created_by":"seth","updated_at":"2026-01-07T15:52:01.545189-05:00","dependencies":[{"issue_id":"shade-plf.4","depends_on_id":"shade-plf","type":"parent-child","created_at":"2026-01-07T15:52:01.54872-05:00","created_by":"seth"},{"issue_id":"shade-plf.4","depends_on_id":"shade-plf.2","type":"blocks","created_at":"2026-01-07T15:52:08.920575-05:00","created_by":"seth"},{"issue_id":"shade-plf.4","depends_on_id":"shade-plf.3","type":"blocks","created_at":"2026-01-07T15:52:08.989644-05:00","created_by":"seth"}]}
{"id":"shade-plf.5","title":"Implement async notification subscription system","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-07T15:52:02.144288-05:00","created_by":"seth","updated_at":"2026-01-07T15:52:02.144288-05:00","dependencies":[{"issue_id":"shade-plf.5","depends_on_id":"shade-plf","type":"parent-child","created_at":"2026-01-07T15:52:02.146889-05:00","created_by":"seth"},{"issue_id":"shade-plf.5","depends_on_id":"shade-plf.4","type":"blocks","created_at":"2026-01-07T15:52:09.889984-05:00","created_by":"seth"}]}
{"id":"shade-plf.6","title":"Create high-level NvimAPI wrapper with typed methods","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-07T15:52:02.642145-05:00","created_by":"seth","updated_at":"2026-01-07T15:52:02.642145-05:00","dependencies":[{"issue_id":"shade-plf.6","depends_on_id":"shade-plf","type":"parent-child","created_at":"2026-01-07T15:52:02.642888-05:00","created_by":"seth"},{"issue_id":"shade-plf.6","depends_on_id":"shade-plf.4","type":"blocks","created_at":"2026-01-07T15:52:09.951767-05:00","created_by":"seth"}]}
{"id":"shade-plf.7","title":"Replace shell-out IPC handlers with native msgpack-rpc calls","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-07T15:52:03.294333-05:00","created_by":"seth","updated_at":"2026-01-07T15:52:03.294333-05:00","dependencies":[{"issue_id":"shade-plf.7","depends_on_id":"shade-plf","type":"parent-child","created_at":"2026-01-07T15:52:03.297203-05:00","created_by":"seth"},{"issue_id":"shade-plf.7","depends_on_id":"shade-plf.6","type":"blocks","created_at":"2026-01-07T15:52:10.09871-05:00","created_by":"seth"}]}
{"id":"shade-plf.8","title":"Implement nvim_buf_attach for buffer change notifications","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-07T15:52:03.88837-05:00","created_by":"seth","updated_at":"2026-01-07T15:52:03.88837-05:00","dependencies":[{"issue_id":"shade-plf.8","depends_on_id":"shade-plf","type":"parent-child","created_at":"2026-01-07T15:52:03.891098-05:00","created_by":"seth"},{"issue_id":"shade-plf.8","depends_on_id":"shade-plf.5","type":"blocks","created_at":"2026-01-07T15:52:10.166752-05:00","created_by":"seth"}]}
{"id":"shade-s7p","title":"Shift key combinations not passed to terminal/PTY","description":"## Bug Description\n\nShift key combinations fail in Shade's embedded terminal:\n- Cannot type `:` (Shift+;) to enter nvim command mode\n- Cannot type `O` (Shift+o) for new line above\n- All shifted characters appear to fail (?, \", {, etc.)\n\n## Works correctly in:\n- Regular nvim in Ghostty\n- Regular nvim in Kitty\n- Previously worked when Shade used Kitty as the terminal backend\n\n## Likely Cause\n\nShade's key event handling is not properly passing the Shift modifier to the PTY/terminal emulator. The issue is likely in how NSEvent key events are translated and written to the PTY.\n\n## Investigation Areas\n\n1. **Key event handling** - Check how `keyDown` events are processed\n   - Look for NSEvent handling in view controllers or custom views\n   - Check if `event.modifierFlags` includes `.shift` and if it's being used\n\n2. **Character translation** - The shifted character should come from `event.characters`, not manual shift handling\n   - `event.characters` = the actual typed character (already shift-aware)\n   - `event.charactersIgnoringModifiers` = the base key\n\n3. **PTY write path** - Verify the correct characters are being written to the PTY fd\n   - Add debug logging to see what bytes are actually sent\n\n4. **SwiftTerm or terminal emulator** - If using a library, check its key handling\n\n## Files to Investigate\n\n- Any `*ViewController.swift` or `*View.swift` with `keyDown` overrides\n- Terminal/PTY setup code\n- Any custom `NSTextInputClient` implementations\n\n## Test Case\n\n1. Launch Shade\n2. Open nvim (or just a shell)\n3. Try typing `:` - should fail (types `;` instead or nothing)\n4. Try typing `O` - should fail (types `o` instead or nothing)\n5. Try typing `?` - should fail","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-07T16:08:58.073974-05:00","created_by":"seth","updated_at":"2026-01-07T16:30:05.7797-05:00","closed_at":"2026-01-07T16:30:05.7797-05:00","close_reason":"Closed"}
